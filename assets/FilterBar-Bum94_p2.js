import{u as z,a as L,s as P,p as B,j as e}from"./index-BytG-fX6.js";import{r as s}from"./vendor-DDTLr4RV.js";import{s as V,am as F,X as O,d as K,u as Q,ao as U,P as Y}from"./utils-CadWPAO0.js";const q=(n,l,u)=>{const{library:o}=z(),x=s.useRef(null),m=o.ambientSounds;return s.useEffect(()=>{const a=new Audio;return a.loop=!0,x.current=a,()=>{a.pause(),x.current=null}},[]),s.useEffect(()=>{const a=x.current;if(a)if(n!=="none"){const r=m.find(h=>h.id===n);if(r&&a.src!==r.url&&r.url&&(a.src=r.url),a.volume=Math.max(0,Math.min(1,u)),l&&(r!=null&&r.url)){const h=a.play();h!==void 0&&h.catch(i=>{console.debug("Ambience play failed:",i)})}else a.pause()}else a.pause()},[n,l,u,m]),x},G=({title:n,category:l,onClose:u})=>{const{preferences:o,updateAudioSettings:x}=L(),{library:m}=z(),{audio:a,goals:r}=o,h=()=>{switch(l){case"breathwork":return r.breathworkMinutes||20;case"meditation":return r.meditationMinutes||20;case"yoga":return r.yogaMinutes||20;case"mantra":return r.mantraMinutes||20;default:return 20}},[i,k]=s.useState(!1),[c,E]=s.useState(h()),[d,w]=s.useState(c*60),[g,v]=s.useState(!1),[y,_]=s.useState(a.ambienceId),[f,A]=s.useState(a.masterVolume),[b,R]=s.useState(!0);q(y,i,f);const N=s.useRef(d),S=s.useRef(c),C=s.useRef(!1),M=s.useRef(null);s.useEffect(()=>{N.current=d},[d]),s.useEffect(()=>{S.current=c},[c]);const p=s.useCallback(()=>{if(C.current)return;const t=S.current*60-N.current;t>30&&(P({id:Date.now().toString(),date:new Date().toISOString(),type:l,title:n,durationSeconds:t}),C.current=!0)},[l,n]);s.useEffect(()=>()=>{p()},[p]),s.useEffect(()=>{i||w(c*60)},[c,i]),s.useEffect(()=>{if(i&&d>0)M.current=setInterval(()=>{w(t=>t-1)},1e3);else if(d===0&&i){if(k(!1),b){const t=m.chimeThemes.find(j=>j.id===a.chimeThemeId)||m.chimeThemes[0];B(t.frequencies.exhale,t.soundType,2.5,f)}p()}return()=>clearInterval(M.current)},[i,d,b,f,p]);const D=()=>{p(),u()},I=()=>{k(!i)},T=t=>{const j=Math.floor(t/60),$=t%60;return`${j}:${$.toString().padStart(2,"0")}`};return e.jsxs("div",{className:"fixed inset-0 z-[60] flex flex-col bg-black overflow-hidden animate-fade-in",children:[e.jsx("style",{children:`
            @keyframes smoke-rise {
                0% { transform: translateY(0) scale(1); opacity: 0; }
                20% { opacity: 0.4; }
                100% { transform: translateY(-100px) scale(2); opacity: 0; }
            }
            .smoke-particle {
                position: absolute;
                background: radial-gradient(circle, rgba(255,255,255,0.4) 0%, transparent 70%);
                border-radius: 50%;
                filter: blur(8px);
                animation: smoke-rise 6s infinite;
            }
            @keyframes flicker {
                0%, 100% { opacity: 0.9; transform: scale(1); }
                50% { opacity: 0.7; transform: scale(0.95); }
                70% { opacity: 1; transform: scale(1.05); }
            }
        `}),e.jsxs("div",{className:"absolute inset-0 z-0",children:[e.jsx("img",{src:"images/sadguru-mangeshda-darkness-to-light.jpg",alt:"Sadguru Mangeshda",className:"w-full h-full object-cover opacity-60"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black via-black/40 to-black/60"})]}),e.jsxs("div",{className:"relative z-20 flex justify-between items-center p-6 pt-8",children:[e.jsx("button",{onClick:D,className:"p-3 bg-white/10 hover:bg-white/20 rounded-full backdrop-blur-md transition-colors text-white",children:e.jsx(V,{size:24})}),e.jsx("button",{onClick:()=>v(!g),className:`p-3 rounded-full backdrop-blur-md transition-colors ${g?"bg-white/30 text-white":"bg-white/10 text-white/80 hover:bg-white/20"}`,children:e.jsx(F,{size:22})})]}),g&&e.jsxs("div",{className:"absolute top-24 right-6 z-40 w-72 bg-black/80 backdrop-blur-xl border border-white/10 rounded-[2rem] p-6 animate-fade-in text-white shadow-2xl",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h4",{className:"text-white font-bold text-lg",children:"Settings"}),e.jsx("button",{onClick:()=>v(!1),children:e.jsx(O,{size:20,className:"text-white/50 hover:text-white"})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-bold text-white/40 uppercase tracking-widest mb-2 block",children:"Ambience"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:m.ambientSounds.map(t=>e.jsx("button",{onClick:()=>_(t.id),className:`p-2 rounded-lg text-xs font-bold transition-all ${y===t.id?"bg-white text-black":"bg-white/10 text-white/60 hover:bg-white/20"}`,children:t.name},t.id))})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-xs text-white/50 font-bold mb-2",children:[e.jsx("span",{children:"Ambience Vol"}),e.jsxs("span",{children:[Math.round(f*100),"%"]})]}),e.jsx("input",{type:"range",min:"0",max:"1",step:"0.05",value:f,onChange:t=>A(parseFloat(t.target.value)),className:"w-full h-1.5 bg-white/20 rounded-full appearance-none cursor-pointer [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-4 [&::-webkit-slider-thumb]:h-4 [&::-webkit-slider-thumb]:bg-white [&::-webkit-slider-thumb]:rounded-full"})]}),e.jsxs("div",{className:"flex justify-between items-center pt-2 border-t border-white/10",children:[e.jsx("span",{className:"text-xs font-bold text-white/40 uppercase tracking-widest",children:"End Chime"}),e.jsx("button",{onClick:()=>R(!b),className:`p-3 rounded-full transition-colors ${b?"bg-white/20 text-white":"bg-white/5 text-white/40"}`,children:b?e.jsx(K,{size:18}):e.jsx(Q,{size:18})})]})]})]}),e.jsxs("div",{className:"relative z-10 flex-1 flex flex-col items-center justify-center text-center p-6",children:[e.jsx("h2",{className:"text-3xl font-serif text-white/90 mb-2",children:n}),e.jsx("p",{className:"text-white/50 text-sm uppercase tracking-[0.2em] mb-12",children:"Self Practice"}),e.jsx("div",{className:"mb-12",children:e.jsx("span",{className:"text-7xl font-mono font-light text-white tabular-nums tracking-tight drop-shadow-2xl",children:T(d)})}),e.jsxs("div",{className:"relative w-40 h-40 flex items-center justify-center mb-12",children:[i&&e.jsxs("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-full h-64 -mt-32 pointer-events-none",children:[e.jsx("div",{className:"smoke-particle w-10 h-10 left-[45%] top-[80%]",style:{animationDelay:"0s"}}),e.jsx("div",{className:"smoke-particle w-12 h-12 left-[50%] top-[85%]",style:{animationDelay:"2s"}}),e.jsx("div",{className:"smoke-particle w-8 h-8 left-[40%] top-[75%]",style:{animationDelay:"4s"}})]}),e.jsx("div",{className:`absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-[20px] transition-opacity duration-1000 ${i?"opacity-100":"opacity-60"}`,children:e.jsx("div",{className:"w-8 h-12 bg-gradient-to-t from-orange-500 via-yellow-400 to-white rounded-[50%_50%_50%_50%_/_60%_60%_40%_40%] blur-[2px] shadow-[0_0_20px_rgba(255,200,0,0.6)]",style:{animation:"flicker 0.2s infinite alternate"}})}),e.jsxs("svg",{width:"100",height:"60",viewBox:"0 0 100 60",className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-[-10px] drop-shadow-2xl",children:[e.jsx("path",{d:"M10 30 Q50 60 90 30 Q50 60 10 30 Z",fill:"#b45309",stroke:"#78350f",strokeWidth:"2"}),e.jsx("ellipse",{cx:"50",cy:"30",rx:"40",ry:"10",fill:"#78350f",opacity:"0.5"})]})]}),e.jsxs("div",{className:"w-full max-w-sm",children:[!i&&e.jsxs("div",{className:"mb-8 px-4",children:[e.jsxs("div",{className:"flex justify-between text-xs text-white/50 font-bold mb-2 uppercase tracking-wide",children:[e.jsx("span",{children:"Duration"}),e.jsxs("span",{children:[c," Min"]})]}),e.jsx("input",{type:"range",min:"5",max:"60",step:"5",value:c,onChange:t=>{E(parseInt(t.target.value)),w(parseInt(t.target.value)*60)},className:"w-full h-1 bg-white/20 rounded-full appearance-none cursor-pointer [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-4 [&::-webkit-slider-thumb]:h-4 [&::-webkit-slider-thumb]:bg-amber-500 [&::-webkit-slider-thumb]:rounded-full"})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx("button",{onClick:I,className:`w-20 h-20 rounded-full flex items-center justify-center shadow-glow transition-transform hover:scale-105 active:scale-95 ${i?"bg-white/10 border border-white/20 text-white":"bg-white text-black"}`,children:i?e.jsx(U,{size:32,fill:"currentColor"}):e.jsx(Y,{size:32,fill:"currentColor",className:"ml-1"})})})]})]})]})},H=({filters:n,selected:l,onSelect:u})=>e.jsxs("div",{className:"flex overflow-x-auto pb-2 pt-2 -mx-6 px-6 gap-3 scrollbar-hide snap-x relative z-30 mask-linear-fade",children:[e.jsx("style",{children:`
        .mask-linear-fade {
          mask-image: linear-gradient(to right, black 90%, transparent 100%);
          -webkit-mask-image: linear-gradient(to right, black 90%, transparent 100%);
        }
      `}),n.map(o=>e.jsx("button",{onClick:()=>u(o),className:`
            snap-start flex-shrink-0 px-5 py-2.5 rounded-2xl text-sm font-bold uppercase tracking-wider transition-all duration-300 border min-h-[44px]
            ${l===o?"bg-spiritual-900 dark:bg-spiritual-100 text-white dark:text-spiritual-900 border-transparent shadow-md":"bg-transparent text-spiritual-500 dark:text-spiritual-400 border-spiritual-200 dark:border-spiritual-700 hover:border-spiritual-400 dark:hover:border-spiritual-500"}
          `,children:o},o)),e.jsx("div",{className:"w-4 flex-shrink-0"})]});export{H as F,G as K,q as u};
