import{o as ge,u as we,a as je,r as a,g as ve,L as Ne,O as A,s as ke,j as e,A as X,Z as ye,H as ee,P as te,I as Re,J as Se,B as Ce,Q as Ae,R as se,Y as De,t as $e,_ as ze,p as Te}from"./index-NUszf3Aq.js";import{u as Ie}from"./useAmbience-CerYbzJY.js";import{P as Ee}from"./pause-DYvX8g4z.js";/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pe=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Me=ge("settings",Pe),Fe=[9,21,54,108],ae=[{label:"Slow",val:1.5,id:"slow"},{label:"Normal",val:1,id:"normal"},{label:"Fast",val:.7,id:"fast"}],_e=1e3,Le=({onClose:_,initialId:k})=>{const{library:p}=we(),{preferences:n}=je(),[r,D]=a.useState(null),[o,f]=a.useState(!1),re=t=>{var s;return((s=ae.find(i=>i.id===t))==null?void 0:s.val)||1},[V,y]=a.useState(0),[g,ie]=a.useState(108),[$,le]=a.useState(re(n.defaults.mantraSpeed)),[G,w]=a.useState(-1),[z,ne]=a.useState(!1),[O,L]=a.useState(!1),[oe,ce]=a.useState(ve()),[T,B]=a.useState("IAST"),[j,de]=a.useState(!0),[u,ue]=a.useState(!1);Ie(n.audio.ambienceId,o,n.audio.masterVolume);const x=a.useRef(0),v=a.useRef(0),h=a.useRef(0),q=a.useRef(Date.now()),m=a.useRef(0),N=a.useRef(!1),I=a.useRef(null),H=a.useRef(!1),W=a.useRef(1),R=a.useRef(!0),J=a.useRef(!1),E=a.useRef(108),b=a.useRef(-1),U=p.chimeThemes.find(t=>t.id===n.audio.chimeThemeId)||p.chimeThemes[0];a.useEffect(()=>{I.current=r,H.current=o,W.current=$,R.current=j,J.current=u,E.current=g},[r,o,$,j,u,g]),a.useEffect(()=>{const t=k&&p.mantras.find(s=>s.id===k)||null;D(t)},[k,p.mantras]),a.useEffect(()=>(o&&(r!=null&&r.rootNote)&&u?Ne(r.rootNote,n.audio.masterVolume*.3):A(),()=>A()),[o,r,u,n.audio.masterVolume]);const Z=(t,s)=>{t&&t.stopPropagation();const i=$e({id:s.id,title:s.title,type:"mantra"});ce(i)},P=t=>oe.some(s=>s.id===t&&s.type==="mantra"),Q=a.useCallback(()=>{const t=I.current,s=m.current;if(t&&s>0){const i=Math.round((Date.now()-q.current)/1e3);i>5&&ke({id:Date.now().toString(),date:new Date().toISOString(),type:"mantra",title:`${t.title} (${s}/${E.current})`,durationSeconds:i,count:s})}},[]);a.useEffect(()=>(r?(q.current=Date.now(),y(0),m.current=0,w(-1),b.current=-1,x.current=0,v.current=0,N.current=!1):(f(!1),cancelAnimationFrame(h.current),A()),()=>{Q(),cancelAnimationFrame(h.current),A()}),[r,Q]);const xe=()=>{k?_():D(null)},Y=t=>{const s=I.current;if(!s||!H.current)return;const i=s.baseDuration*1e3*W.current,pe=R.current?_e:0,fe=i+pe,S=t-x.current;if(S<i){const c=s.syllables.reduce((l,C)=>l+C.durationRatio,0),K=i/c;let M=0,d=-1;for(let l=0;l<s.syllables.length;l++){const F=s.syllables[l].durationRatio*K;if(S>=M&&S<M+F){d=l;break}M+=F}if(d!==-1&&d!==b.current){const l=s.syllables[d],C=l.type==="punctuation";J.current&&l.note&&(!C||R.current)&&ze(l.note,l.durationRatio*K/1e3,n.audio.masterVolume),b.current=d}d===s.syllables.length-1&&!N.current&&R.current&&(Te(U.frequencies.hold,U.soundType,2.5,n.audio.masterVolume),N.current=!0),w(l=>l!==d?d:l)}else if(S<fe)w(c=>c!==-1?-1:c),b.current=-1;else{const c=m.current+1;if(m.current=c,y(c),x.current=t,N.current=!1,b.current=-1,navigator.vibrate&&navigator.vibrate(10),c>=E.current){f(!1),w(-1),navigator.vibrate&&navigator.vibrate([20,50,20]);return}}h.current=requestAnimationFrame(Y)},he=()=>{if(o)f(!1),cancelAnimationFrame(h.current),v.current=performance.now();else{if(f(!0),v.current>0){const t=performance.now()-v.current;x.current+=t}else x.current=performance.now();h.current=requestAnimationFrame(Y)}},me=()=>{f(!1),cancelAnimationFrame(h.current),y(0),m.current=0,w(-1),x.current=0,v.current=0,N.current=!1,b.current=-1};if(!r)return e.jsxs("div",{className:"pb-36 min-h-screen bg-spiritual-50 dark:bg-spiritual-deep animate-fade-in flex flex-col",children:[e.jsxs("div",{className:"p-6 pt-8 pb-12 rounded-b-[3rem] shadow-soft relative z-10 flex flex-col gap-6 bg-gradient-to-br from-amber-50 via-white to-amber-100 dark:from-amber-900 dark:via-spiritual-deep dark:to-amber-900/10",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("button",{onClick:_,className:"p-3 bg-white dark:bg-white/10 rounded-full shadow-sm hover:scale-105 transition-transform text-spiritual-600 dark:text-spiritual-200","aria-label":"Back",children:e.jsx(X,{size:24})}),e.jsx("div",{className:"w-12"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 rounded-2xl bg-amber-100/50 dark:bg-amber-900/30 text-amber-600 dark:text-amber-400 shadow-sm backdrop-blur-sm",children:e.jsx(ye,{size:32,strokeWidth:1.5})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold text-spiritual-900 dark:text-spiritual-50",children:"Mantra Japa"}),e.jsx("p",{className:"text-spiritual-500 dark:text-spiritual-400 font-medium",children:"Recitation & Vibration"})]})]})]}),e.jsx("div",{className:"flex-1 p-6 max-w-2xl mx-auto w-full relative z-20 space-y-5",children:p.mantras.map(t=>{const s=P(t.id);return e.jsxs("div",{onClick:()=>D(t),className:"bg-white dark:bg-spiritual-900/60 p-6 rounded-[2.5rem] shadow-soft border border-spiritual-100 dark:border-spiritual-700/50 flex items-center gap-6 cursor-pointer hover:shadow-lg hover:-translate-y-1 transition-all group relative overflow-hidden",children:[e.jsx("div",{className:`absolute inset-0 opacity-0 group-hover:opacity-10 transition-opacity bg-gradient-to-r ${t.theme.bgGradient}`}),e.jsx("div",{className:`w-20 h-20 rounded-3xl bg-gradient-to-br ${t.theme.bgGradient} text-white flex items-center justify-center flex-shrink-0 shadow-md group-hover:scale-105 transition-transform`,children:e.jsx("span",{className:"text-2xl font-serif font-bold opacity-90",children:t.sanskritTitle.charAt(0)})}),e.jsxs("div",{className:"flex-1 min-w-0 relative z-10",children:[e.jsx("div",{className:"flex items-center gap-2 mb-1",children:e.jsx("span",{className:"px-2 py-0.5 rounded-md bg-spiritual-100 dark:bg-spiritual-800 text-[10px] font-bold text-spiritual-500 uppercase tracking-wider",children:t.deity})}),e.jsx("h3",{className:"text-xl font-bold text-spiritual-900 dark:text-spiritual-100",children:t.title}),e.jsx("p",{className:"text-spiritual-500 dark:text-spiritual-400 text-sm truncate",children:t.meaning})]}),e.jsxs("div",{className:"flex flex-col items-center gap-3 relative z-10",children:[e.jsx("button",{onClick:i=>Z(i,t),className:`p-2 rounded-full transition-colors ${s?"text-red-500 bg-red-50 dark:bg-red-900/20":"text-spiritual-300 dark:text-spiritual-600 hover:text-red-400 hover:bg-spiritual-50 dark:hover:bg-spiritual-800"}`,children:e.jsx(ee,{size:20,fill:s?"currentColor":"none"})}),e.jsx("div",{className:"w-10 h-10 rounded-full bg-spiritual-50 dark:bg-spiritual-800 flex items-center justify-center text-spiritual-400 dark:text-spiritual-500 group-hover:bg-spiritual-800 group-hover:text-white dark:group-hover:bg-spiritual-100 dark:group-hover:text-spiritual-800 transition-colors",children:e.jsx(te,{size:16,fill:"currentColor"})})]})]},t.id)})})]});const be=T==="DEVANAGARI";return e.jsxs("div",{className:"fixed inset-0 z-[60] flex flex-col landscape:flex-row bg-spiritual-deep overflow-hidden animate-fade-in transition-colors duration-1000",children:[e.jsx("div",{className:`absolute inset-0 bg-gradient-to-b ${r.theme.bgGradient} opacity-90 transition-opacity duration-1000`}),e.jsx("div",{className:"absolute inset-0 bg-black/30 backdrop-blur-sm"}),e.jsxs("div",{className:"absolute top-0 left-0 w-full z-30 flex justify-between items-center p-6 pt-8 text-white",children:[e.jsx("button",{onClick:xe,className:"p-3 bg-white/10 hover:bg-white/20 rounded-full backdrop-blur-md transition-colors",children:e.jsx(X,{size:24})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>L(!0),className:`p-3 rounded-full backdrop-blur-md transition-colors ${O?"bg-white/20":"bg-white/10 hover:bg-white/20"}`,children:e.jsx(Re,{size:20})}),e.jsx("button",{onClick:()=>ne(!z),className:`p-3 rounded-full backdrop-blur-md transition-colors ${z?"bg-white/20":"bg-white/10 hover:bg-white/20"}`,children:e.jsx(Me,{size:20})}),e.jsx("button",{onClick:t=>Z(t,r),className:`p-3 rounded-full backdrop-blur-md transition-colors ${P(r.id)?"bg-red-500/20 text-red-400":"bg-white/10 hover:bg-white/20"}`,children:e.jsx(ee,{size:20,fill:P(r.id)?"currentColor":"none"})})]})]}),z&&e.jsx("div",{className:"absolute top-24 right-6 z-40 w-64 bg-black/80 backdrop-blur-xl border border-white/10 rounded-3xl p-5 animate-fade-in",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center pt-2 pb-2 border-b border-white/10",children:[e.jsxs("label",{className:"text-xs font-bold text-white/40 uppercase tracking-widest flex items-center gap-2",children:[e.jsx(Se,{size:14})," Melodic Guide (Experimental)"]}),e.jsx("button",{onClick:()=>ue(!u),className:`w-12 h-6 rounded-full p-1 transition-colors ${u?"bg-white":"bg-white/10"}`,children:e.jsx("div",{className:`w-4 h-4 rounded-full shadow-sm transform transition-transform ${u?"translate-x-6 bg-black":"translate-x-0 bg-white/50"}`})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-white/40 uppercase tracking-widest block mb-3",children:"Target Count"}),e.jsx("div",{className:"grid grid-cols-4 gap-2",children:Fe.map(t=>e.jsx("button",{onClick:()=>{ie(t),y(0),m.current=0},className:`py-2 rounded-lg text-xs font-bold transition-colors ${g===t?"bg-white text-black":"bg-white/10 text-white/60 hover:bg-white/20"}`,children:t},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-white/40 uppercase tracking-widest block mb-3",children:"Chanting Speed"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:ae.map(t=>e.jsx("button",{onClick:()=>le(t.val),className:`py-2 rounded-lg text-xs font-bold transition-colors ${$===t.val?"bg-white text-black":"bg-white/10 text-white/60 hover:bg-white/20"}`,children:t.label},t.label))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-white/40 uppercase tracking-widest block mb-3",children:"Script"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("button",{onClick:()=>B("IAST"),className:`py-2 rounded-lg text-xs font-bold transition-colors ${T==="IAST"?"bg-white text-black":"bg-white/10 text-white/60 hover:bg-white/20"}`,children:"Latin"}),e.jsx("button",{onClick:()=>B("DEVANAGARI"),className:`py-2 rounded-lg text-xs font-bold transition-colors ${T==="DEVANAGARI"?"bg-white text-black":"bg-white/10 text-white/60 hover:bg-white/20"}`,children:"Devanagari"})]})]}),e.jsxs("div",{className:"flex justify-between items-center pt-2 border-t border-white/10",children:[e.jsx("label",{className:"text-xs font-bold text-white/40 uppercase tracking-widest",children:"Interval Chime"}),e.jsx("button",{onClick:()=>de(!j),className:`w-12 h-6 rounded-full p-1 transition-colors ${j?"bg-white":"bg-white/10"}`,children:e.jsx("div",{className:`w-4 h-4 rounded-full shadow-sm transform transition-transform ${j?"translate-x-6 bg-black":"translate-x-0 bg-white/50"}`})})]})]})}),O&&e.jsxs(Ce,{onClose:()=>L(!1),title:r.title,subtitle:"Mantra Details",icon:e.jsx(Ae,{size:24}),children:[e.jsxs("div",{className:"p-6 bg-white/5 rounded-3xl border border-white/5",children:[e.jsx("p",{className:"text-3xl font-serif text-white/90 mb-2 leading-relaxed",children:r.sanskritTitle}),e.jsxs("p",{className:"text-lg text-white/60 italic leading-relaxed",children:['"',r.meaning,'"']})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-4 bg-white/5 rounded-2xl border border-white/5",children:[e.jsx("span",{className:"block text-xs font-bold text-white/40 uppercase tracking-widest mb-1",children:"Deity"}),e.jsx("span",{className:"text-lg font-bold text-white",children:r.deity})]}),e.jsxs("div",{className:"p-4 bg-white/5 rounded-2xl border border-white/5",children:[e.jsx("span",{className:"block text-xs font-bold text-white/40 uppercase tracking-widest mb-1",children:"Rishi"}),e.jsx("span",{className:"text-lg font-bold text-white",children:r.meta.rishi})]})]})]}),e.jsxs("div",{className:"relative z-10 flex-1 flex flex-col items-center justify-center p-6 pt-24 landscape:pt-0 landscape:w-2/3 text-center",children:[e.jsxs("div",{className:"mb-12 landscape:mb-8",children:[e.jsx("h2",{className:"text-4xl font-bold text-white/90 mb-4 font-serif tracking-wide",children:r.sanskritTitle}),e.jsx("p",{className:"text-white/40 text-sm uppercase tracking-[0.2em]",children:r.title})]}),be?e.jsx("div",{className:"max-w-xl mx-auto min-h-[120px] content-center text-center leading-[3rem] md:leading-[4rem]",children:r.syllables.map((t,s)=>{const i=s===G;return t.type==="punctuation"?e.jsx("span",{className:`mx-3 font-light inline-block transition-all duration-300 ${i?"text-amber-400 scale-125":"text-amber-500/30 scale-100"}`,children:t.text},s):e.jsxs(se.Fragment,{children:[e.jsx("span",{className:`transition-all duration-200 font-serif text-3xl md:text-4xl inline-block ${i?"text-amber-300 drop-shadow-[0_0_15px_rgba(251,191,36,0.6)]":"text-white/40"}`,children:t.textDevanagari||t.text}),t.spaceAfter&&e.jsx("span",{children:"  "})]},s)})}):e.jsx("div",{className:"flex flex-wrap justify-center items-center gap-x-3 gap-y-4 max-w-xl mx-auto min-h-[120px] content-center",children:r.syllables.map((t,s)=>{const i=s===G;return t.type==="punctuation"?e.jsx("span",{className:`mx-2 font-light inline-block transition-all duration-300 ${i?"text-amber-400 scale-150":"text-white/20 scale-100"}`,children:t.text},s):e.jsx(se.Fragment,{children:e.jsx("span",{className:`transition-all duration-300 font-serif text-2xl md:text-3xl ${i?`scale-125 ${r.theme.textHighlight} drop-shadow-[0_0_15px_rgba(255,255,255,0.5)]`:"text-white/30 scale-100 blur-[0.5px]"}`,children:t.text})},s)})})]}),e.jsx("div",{className:"relative z-10 bg-black/20 backdrop-blur-xl border-t border-white/5 landscape:border-t-0 landscape:border-l p-8 pb-12 rounded-t-[3rem] landscape:rounded-none landscape:w-1/3 landscape:h-full landscape:flex landscape:flex-col landscape:justify-center landscape:pb-8",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs("div",{className:"mb-8 flex items-center gap-8 w-full justify-center",children:[e.jsxs("div",{className:"text-right flex-1",children:[e.jsx("span",{className:"block text-3xl font-bold text-white font-mono",children:V}),e.jsx("span",{className:"text-xs font-bold text-white/30 uppercase tracking-widest",children:"Completed"})]}),e.jsx("div",{className:"relative w-20 h-20 flex items-center justify-center flex-shrink-0",children:e.jsxs("svg",{className:"w-full h-full -rotate-90",viewBox:"0 0 80 80",children:[e.jsx("circle",{cx:"40",cy:"40",r:"36",stroke:"currentColor",strokeWidth:"4",fill:"none",className:"text-white/10"}),e.jsx("circle",{cx:"40",cy:"40",r:"36",stroke:"currentColor",strokeWidth:"4",fill:"none",className:`${r.theme.accent} transition-all duration-500`,strokeDasharray:226,strokeDashoffset:226-226*(V/g),strokeLinecap:"round"}),e.jsx("g",{className:"animate-spin-slow",style:{transformOrigin:"40px 40px",animationDuration:"20s"},children:e.jsx("circle",{cx:"40",cy:"4",r:"5",fill:"white",className:"drop-shadow-[0_0_4px_rgba(255,255,255,0.8)]"})})]})}),e.jsxs("div",{className:"text-left flex-1",children:[e.jsx("span",{className:"block text-3xl font-bold text-white/50 font-mono",children:g}),e.jsx("span",{className:"text-xs font-bold text-white/30 uppercase tracking-widest",children:"Target"})]})]}),e.jsxs("div",{className:"flex items-center gap-8",children:[e.jsx("button",{onClick:me,className:"p-4 rounded-full text-white/40 hover:bg-white/10 hover:text-white transition-colors",children:e.jsx(De,{size:24})}),e.jsx("button",{onClick:he,className:`w-20 h-20 rounded-full flex items-center justify-center shadow-2xl transition-transform hover:scale-105 active:scale-95 text-white ${o?"bg-white/10 border border-white/20":"bg-white text-black"}`,children:o?e.jsx(Ee,{size:32,fill:"currentColor"}):e.jsx(te,{size:32,fill:"currentColor",className:"ml-1"})}),e.jsx("div",{className:"p-4 w-14"})]})]})})]})};export{Le as default};
