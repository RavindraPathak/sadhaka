import{v as xe,r,w as fe,a as me,x as ge,y as be,z as we,E as ke,F as ye,G as ve,J as je,K as qe,j as e,e as Ne,h as Se,S as K,L as Te,R as Ce,M as Ie,O as De,Q as Ee,Y as V,Z as Me,T as Re,f as Ae,m as ze,_ as Le}from"./index-2Bv_vk10.js";import{S as We}from"./save-CSkfdZAG.js";/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pe=[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M16.95 16.95A7 7 0 0 1 5 12v-2",key:"cqa7eg"}],["path",{d:"M18.89 13.23A7 7 0 0 0 19 12v-2",key:"16hl24"}],["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}]],Oe=xe("mic-off",Pe),Fe=["What is my Sankalp (intention) for today?","How can I serve others today?","What quality of the Divine do I wish to embody today?","What am I grateful for as I wake up?","Today, I will practice mindfulness by...","What is one thing I can let go of today?","Who needs my love and patience today?","If today was my last day, how would I live it?"],$e=["Where did I lose my awareness today?","Did I act out of ego or love in my interactions?","What was the most beautiful moment of today?","What lesson did my challenges teach me?","Did I stay true to my Sankalp today?","Who did I help today?","What am I holding onto that I can release before sleep?","How did I nurture my body and soul today?"],Y=["In this moment, I am feeling...","The silence is telling me...","What is preventing me from being fully present?","I feel closest to the Divine when...","What fear is holding me back?","My breath feels...","Focus on the space between thoughts.","Reflect on a recent reaction. Was it conscious or compulsive?"],He=()=>{const a=new Date().getHours();let o=Y;a>=5&&a<12?o=Fe:(a>=18||a<5)&&(o=$e),Math.random()>.7&&(o=[...o,...Y]);const m=Math.floor(Math.random()*o.length);return o[m]},_e=()=>{const[a,o]=r.useState(!1),[m,j]=r.useState(""),[A,k]=r.useState(!1),w=r.useRef(null),l=r.useRef(null);r.useEffect(()=>{if(typeof window<"u"&&("webkitSpeechRecognition"in window||"SpeechRecognition"in window)){k(!0);const p=window.SpeechRecognition||window.webkitSpeechRecognition,n=new p;n.continuous=!0,n.interimResults=!1,n.lang="en-US";const x=()=>{l.current&&clearTimeout(l.current),l.current=setTimeout(()=>{n.stop()},5e3)};n.onstart=()=>{x()},n.onresult=c=>{x();let y="";for(let g=c.resultIndex;g<c.results.length;++g)c.results[g].isFinal&&(y+=c.results[g][0].transcript);y.trim()&&j(g=>g+(g?" ":"")+y.trim())},n.onerror=c=>{c.error!=="no-speech"&&console.error("Speech recognition error",c.error),o(!1),l.current&&clearTimeout(l.current)},n.onend=()=>{o(!1),l.current&&clearTimeout(l.current)},w.current=n}return()=>{l.current&&clearTimeout(l.current)}},[]);const q=r.useCallback(()=>{if(w.current&&!a){j("");try{w.current.start(),o(!0)}catch(p){console.error("Failed to start recognition:",p)}}},[a]),f=r.useCallback(()=>{w.current&&a&&(w.current.stop(),o(!1))},[a]),N=r.useCallback(()=>{a?f():q()},[a,q,f]);return{isListening:a,transcript:m,resetTranscript:()=>j(""),toggleListening:N,isSupported:A}},Ge="Did I fulfil my intention? What is my honest confession to my Guru?",Je="How were my reactions today, what did I learn from my interactions?",Ue="How is my spiritual bank balance, Did I make people smile today?",H="Did I fulfil my intention? What is my honest confession to my Guru?",Z="How were my reactions today, what did I learn from my interactions?",X="How is my spiritual bank balance, Did I make people smile today?",_=()=>{const a=new Date;return new Date(a.getTime()-a.getTimezoneOffset()*6e4).toISOString().split("T")[0]},Ke=({onClose:a,initialEntryId:o})=>{const{showToast:m}=fe(),{preferences:j}=me(),A=j.location||ge,[k,w]=r.useState(_()),[l,q]=r.useState(o||null),[f,N]=r.useState(null),[p,n]=r.useState({q1:"",q2:"",q3:""}),[x,c]=r.useState("q1"),[y,g]=r.useState([]),[S,E]=r.useState([]),[ee,z]=r.useState(!1),[te,G]=r.useState(!1),T=r.useRef({q1:null,q2:null,q3:null}),L=r.useRef(0),{isListening:W,transcript:C,resetTranscript:J,toggleListening:se,isSupported:re}=_e();r.useEffect(()=>{g(be())},[]);const b=t=>{const s=T.current[t];s&&(L.current=s.selectionStart,c(t))};r.useEffect(()=>{if(C){const t=p[x],s=L.current,u=t.substring(0,s),d=t.substring(s),i=u.length>0&&!u.endsWith(" ")&&!u.endsWith(`
`)&&!C.startsWith(" ")?" ":"",h=u+i+C+d,F=s+i.length+C.length;n($=>({...$,[x]:h})),L.current=F,J()}},[C,J,x,p]);const[I,P]=r.useState(null),v=new Date(k);v.setHours(12,0,0,0);const M=we(v),R=ke(v),ie=ye(v),U=ve(v,A.timezone),Q=je(v),ae=t=>{if(!t)return{q1:"",q2:"",q3:""};try{const h=JSON.parse(t);if(h&&(typeof h.q1=="string"||typeof h.q2=="string"))return{q1:h.q1||"",q2:h.q2||"",q3:h.q3||""}}catch{}const s=t.replace(/\r\n/g,`
`),u=s.indexOf(`**${H}**`),d=s.indexOf(`**${Z}**`),i=s.indexOf(`**${X}**`);if(u!==-1&&d!==-1&&i!==-1){const h=he=>he.trim().replace(/^\.\.\.\s*/,""),F=s.substring(u+H.length+4,d).trim(),$=s.substring(d+Z.length+4,i).trim(),pe=s.substring(i+X.length+4).trim();return{q1:h(F),q2:h($),q3:h(pe)}}return s.includes(H)&&s.length<500&&s.includes("...")?{q1:"",q2:"",q3:""}:{q1:s,q2:"",q3:""}},O=(t,s)=>{const u=Ae();let d=s?u.find(i=>i.id===s):u.find(i=>i.date.split("T")[0]===t);d?(w(d.date.split("T")[0]),q(d.id),N(d.mood),n(ae(d.text)),E([])):(w(t),q(null),N(null),n({q1:"",q2:"",q3:""}),E([]))};r.useEffect(()=>{o?O("",o):O(_())},[o]);const ne=t=>{O(t)},D=()=>{E(t=>[...t,{...p}])},oe=()=>{if(S.length===0)return;const t=S[S.length-1];n(t),E(s=>s.slice(0,-1))},le=()=>{if(!f){m("Please select your mood (The Ankush)","error"),G(!0),setTimeout(()=>G(!1),800);return}if(!Object.values(p).some(i=>i.trim().length>0)){m("Please write your reflections before saving.","error");return}const s=y.filter(i=>i.completedDates.includes(k)).map(i=>i.title),u=JSON.stringify(p),d={id:l||Date.now().toString(),date:new Date(`${k}T00:00:00.000Z`).toISOString(),mood:f,text:u,completedDisciplines:s,panchang:{tithi:`${M.name} (${M.type})`,moonPhase:ie.phase,vaar:U,maasa:Q.name,specialDay:R?R.name:void 0},tags:[],reaction:"neutral",madeSomeoneSmile:!1,learning:""};Le(d),m("Journal saved"),a()},ce=()=>{D();const t=He(),s=p[x],u=s.length>0?`

`:"",d=s+`${u}[Prompt: ${t}]
`;n(i=>({...i,[x]:d})),requestAnimationFrame(()=>{const i=T.current[x];i&&(i.focus(),i.scrollTop=i.scrollHeight)})},de=()=>{l&&P({title:"Delete Entry?",message:"This action cannot be undone.",confirmText:"Delete",onConfirm:()=>{ze(l),m("Entry deleted","info"),a()}})},B=y.filter(t=>t.completedDates.includes(k)),{rootColor:ue}=qe(f||"");return e.jsxs("div",{className:"fixed inset-0 z-[60] bg-spiritual-50 dark:bg-spiritual-deep flex flex-col animate-fade-in overflow-hidden",children:[e.jsxs("div",{className:"sticky top-0 z-50 pt-8 pb-4 px-6 rounded-b-[2rem] shadow-soft flex items-center justify-between bg-gradient-to-br from-spiritual-50 via-white to-spiritual-gold/20 dark:from-spiritual-900 dark:via-spiritual-deep dark:to-spiritual-gold/10 backdrop-blur-md",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:a,className:"p-2.5 bg-white dark:bg-white/10 rounded-full shadow-sm hover:scale-105 transition-transform text-spiritual-600 dark:text-spiritual-200","aria-label":"Back",children:e.jsx(Ne,{size:20})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-spiritual-900 dark:text-spiritual-50",children:l?"Edit Entry":"New Entry"}),e.jsx("p",{className:"text-xs text-spiritual-600 dark:text-spiritual-400 font-bold uppercase tracking-wider",children:"Capture your thoughts"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[l&&e.jsx("button",{onClick:de,className:"p-2.5 bg-white dark:bg-white/10 rounded-full shadow-sm text-spiritual-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/10 transition-colors",title:"Delete Entry",children:e.jsx(Se,{size:20})}),e.jsxs("button",{onClick:le,className:"px-4 py-2 bg-spiritual-800 dark:bg-spiritual-100 text-white dark:text-spiritual-900 rounded-full font-bold shadow-md hover:scale-105 active:scale-95 transition-all flex items-center gap-2",children:[e.jsx(We,{size:18}),e.jsx("span",{className:"hidden sm:inline",children:"Save"})]})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto px-6 pb-32",children:e.jsxs("div",{className:"max-w-2xl mx-auto pt-4 space-y-8",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("input",{type:"date",value:k,onChange:t=>{const s=t.target.value;s>_()&&m("Future date selected","info"),ne(s)},className:"bg-transparent border-none text-sm font-bold text-spiritual-400 uppercase tracking-widest focus:outline-none focus:text-spiritual-600 dark:focus:text-spiritual-200"}),e.jsxs("div",{className:"flex flex-col gap-1 mt-1",children:[e.jsxs("h2",{className:"text-xl font-serif font-bold text-spiritual-900 dark:text-spiritual-100 flex items-center gap-2 flex-wrap",children:[M.name," ",e.jsx("span",{className:"text-sm font-normal text-spiritual-500 dark:text-spiritual-400",children:M.type==="Shukla"?"• Waxing":"• Waning"})]}),e.jsxs("div",{className:"flex flex-wrap gap-x-3 text-sm text-spiritual-500 dark:text-spiritual-400 font-medium",children:[e.jsx("span",{className:"text-spiritual-800 dark:text-spiritual-200",children:U}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:[Q.name," Maasa"]})]}),R&&e.jsxs("div",{className:"text-amber-600 dark:text-amber-400 font-bold flex items-center gap-1.5 mt-1 animate-pulse-slow",children:[e.jsx(K,{size:14})," ",R.name]})]})]}),B.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-bold text-spiritual-400 uppercase tracking-widest mb-2",children:"Accomplished Today"}),e.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 -mx-6 px-6 scrollbar-hide",children:B.map(t=>e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 rounded-xl text-xs font-bold whitespace-nowrap bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300 border border-green-200 dark:border-green-800",children:[e.jsx(Te,{size:12,strokeWidth:4}),t.title]},t.id))})]}),e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"space-y-3",onClick:()=>c("q1"),children:[e.jsx("p",{className:"text-spiritual-900 dark:text-spiritual-100 font-bold text-lg leading-snug",children:Ge}),e.jsx("textarea",{ref:t=>{T.current.q1=t},value:p.q1,onChange:t=>{n(s=>({...s,q1:t.target.value})),D()},onFocus:()=>c("q1"),onSelect:()=>b("q1"),onClick:()=>b("q1"),onKeyUp:()=>b("q1"),placeholder:"Reflect here...",className:`w-full min-h-[140px] p-5 rounded-2xl resize-none text-base leading-relaxed font-serif transition-colors
                                bg-white dark:bg-white/5 
                                text-spiritual-800 dark:text-spiritual-200 
                                placeholder:text-spiritual-300 dark:placeholder:text-white/20
                                border border-spiritual-100 dark:border-white/10
                                focus:outline-none focus:ring-2 focus:ring-spiritual-200 dark:focus:ring-white/10
                                ${x==="q1"?"ring-2 ring-spiritual-200 dark:ring-white/10":""}
                            `})]}),e.jsxs("div",{className:"space-y-3",onClick:()=>c("q2"),children:[e.jsx("p",{className:"text-spiritual-900 dark:text-spiritual-100 font-bold text-lg leading-snug",children:Je}),e.jsx("textarea",{ref:t=>{T.current.q2=t},value:p.q2,onChange:t=>{n(s=>({...s,q2:t.target.value})),D()},onFocus:()=>c("q2"),onSelect:()=>b("q2"),onClick:()=>b("q2"),onKeyUp:()=>b("q2"),placeholder:"Reflect here...",className:`w-full min-h-[140px] p-5 rounded-2xl resize-none text-base leading-relaxed font-serif transition-colors
                                bg-white dark:bg-white/5 
                                text-spiritual-800 dark:text-spiritual-200 
                                placeholder:text-spiritual-300 dark:placeholder:text-white/20
                                border border-spiritual-100 dark:border-white/10
                                focus:outline-none focus:ring-2 focus:ring-spiritual-200 dark:focus:ring-white/10
                                ${x==="q2"?"ring-2 ring-spiritual-200 dark:ring-white/10":""}
                            `})]}),e.jsxs("div",{className:"space-y-3",onClick:()=>c("q3"),children:[e.jsx("p",{className:"text-spiritual-900 dark:text-spiritual-100 font-bold text-lg leading-snug",children:Ue}),e.jsx("textarea",{ref:t=>{T.current.q3=t},value:p.q3,onChange:t=>{n(s=>({...s,q3:t.target.value})),D()},onFocus:()=>c("q3"),onSelect:()=>b("q3"),onClick:()=>b("q3"),onKeyUp:()=>b("q3"),placeholder:"Reflect here...",className:`w-full min-h-[140px] p-5 rounded-2xl resize-none text-base leading-relaxed font-serif transition-colors
                                bg-white dark:bg-white/5 
                                text-spiritual-800 dark:text-spiritual-200 
                                placeholder:text-spiritual-300 dark:placeholder:text-white/20
                                border border-spiritual-100 dark:border-white/10
                                focus:outline-none focus:ring-2 focus:ring-spiritual-200 dark:focus:ring-white/10
                                ${x==="q3"?"ring-2 ring-spiritual-200 dark:ring-white/10":""}
                            `})]})]})]})}),e.jsx("div",{className:"absolute bottom-8 left-0 right-0 flex justify-center items-end gap-4 pointer-events-none z-50",children:e.jsxs("div",{className:"glass dark:bg-spiritual-900/90 backdrop-blur-xl p-2 rounded-full shadow-lg pointer-events-auto flex items-center gap-2 border border-white/20",children:[e.jsx("button",{onClick:oe,disabled:S.length===0,className:`p-4 rounded-full transition-all ${S.length===0?"text-spiritual-300 dark:text-white/20":"bg-spiritual-100 dark:bg-white/10 text-spiritual-600 dark:text-spiritual-200 hover:scale-105 active:scale-95"}`,title:"Undo",children:e.jsx(Ce,{size:24})}),e.jsx("button",{onClick:ce,className:"p-4 rounded-full bg-spiritual-100 dark:bg-white/10 text-spiritual-600 dark:text-spiritual-200 hover:bg-spiritual-200 dark:hover:bg-white/20 transition-all hover:scale-105 active:scale-95",title:"Get Prompt (Inserts into active box)",children:e.jsx(K,{size:24})}),re&&e.jsx("button",{onClick:()=>{W||(De(),Ee(),D()),se()},className:`p-4 rounded-full transition-all hover:scale-105 active:scale-95 shadow-md ${W?"bg-red-500 text-white animate-pulse":"bg-spiritual-800 dark:bg-spiritual-100 text-white dark:text-spiritual-900"}`,title:"Voice Dictation",children:W?e.jsx(Oe,{size:24}):e.jsx(Ie,{size:24})}),e.jsx("button",{onClick:()=>z(!0),className:`p-4 rounded-full transition-all hover:scale-105 active:scale-95 flex items-center justify-center border-2 
                        ${te?"animate-bounce border-red-400 bg-red-100":""}
                        ${f?"bg-white/5 border-transparent":"bg-spiritual-100 dark:bg-white/10 border-transparent text-spiritual-600 dark:text-spiritual-200"}
                    `,style:f?{backgroundColor:ue,color:"#FFF"}:{},title:"Set Mood",children:f?e.jsx(V,{size:24,fill:"currentColor"}):e.jsx(V,{size:24})})]})}),ee&&e.jsx(Me,{initialMood:f,onSelect:t=>{N(t),z(!1)},onClose:()=>z(!1)}),I&&e.jsx("div",{className:"fixed inset-0 bg-spiritual-deep/80 backdrop-blur-md z-[80] flex items-center justify-center p-4 animate-fade-in",children:e.jsxs("div",{className:"bg-white dark:bg-spiritual-900 w-full max-w-sm rounded-[2.5rem] p-8 shadow-2xl border border-white/10 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-amber-50 dark:bg-amber-900/20 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(Re,{size:32,className:"text-amber-500"})}),e.jsx("h3",{className:"text-2xl font-bold text-spiritual-900 dark:text-spiritual-100 mb-2",children:I.title}),e.jsx("p",{className:"text-spiritual-500 dark:text-spiritual-400 mb-8",children:I.message}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("button",{onClick:()=>{I.onConfirm(),P(null)},className:"w-full py-4 bg-spiritual-800 dark:bg-spiritual-100 text-white dark:text-spiritual-900 rounded-2xl font-bold transition-transform active:scale-95",children:I.confirmText}),e.jsx("button",{onClick:()=>P(null),className:"w-full py-3 text-spiritual-500 font-bold transition-colors hover:text-spiritual-800 dark:hover:text-white",children:"Cancel"})]})]})})]})};export{Ke as default};
