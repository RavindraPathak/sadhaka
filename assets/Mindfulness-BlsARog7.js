import{u as A,r as a,g as _,j as e,C as G,H as z,G as S,P as C,V as B,A as H,E as I,s as O,t as U}from"./index-BAPzlSzb.js";import{P as W}from"./pause-fANKumkt.js";import{V as X}from"./volume-x-lBVYmZv4.js";const Q=({onClose:h,initialId:c})=>{const{library:E}=A(),m=E.meditation,[i,p]=a.useState(null),[o,x]=a.useState(!1),[b,g]=a.useState(0),[v,P]=a.useState(0),[u,M]=a.useState(.8),[l,j]=a.useState(!1),[L,T]=a.useState(_()),r=a.useRef(null),d=a.useRef(null),f=a.useRef(0);a.useEffect(()=>{if(c){const t=m.find(s=>s.id===c);t&&p(t)}},[c,m]);const w=(t,s)=>{t&&t.stopPropagation();const n=U({id:s.id,title:s.title,type:"meditation"});T(n)},k=t=>L.some(s=>s.id===t&&s.type==="meditation");a.useEffect(()=>{o?d.current=Date.now():d.current&&(f.current+=Date.now()-d.current,d.current=null)},[o]);const D=()=>{let t=f.current;o&&d.current&&(t+=Date.now()-d.current),i&&t>3e4&&O({id:Date.now().toString(),date:new Date().toISOString(),type:"meditation",title:i.title,durationSeconds:Math.round(t/1e3)}),f.current=0,d.current=null,x(!1),c?h():p(null)};a.useEffect(()=>(i&&r.current&&(r.current.src=i.url,r.current.volume=l?0:u,r.current.play().then(()=>x(!0)).catch(t=>console.log("Audio play failed",t))),()=>{r.current&&(r.current.pause(),r.current.src="")}),[i]),a.useEffect(()=>{const t=r.current;if(!t)return;const s=()=>g(t.currentTime),n=()=>P(t.duration),y=()=>x(!1);return t.addEventListener("timeupdate",s),t.addEventListener("loadedmetadata",n),t.addEventListener("ended",y),()=>{t.removeEventListener("timeupdate",s),t.removeEventListener("loadedmetadata",n),t.removeEventListener("ended",y)}},[i]),a.useEffect(()=>{r.current&&(r.current.volume=l?0:u)},[u,l]);const V=()=>{r.current&&(o?r.current.pause():r.current.play(),x(!o))},F=t=>{const s=Number(t.target.value);r.current&&(r.current.currentTime=s,g(s))},R=t=>{const s=parseFloat(t.target.value);M(s),s>0&&l&&j(!1)},$=()=>{j(!l)},N=t=>{if(isNaN(t))return"0:00";const s=Math.floor(t/60),n=Math.floor(t%60);return`${s}:${n.toString().padStart(2,"0")}`};if(i){const t=k(i.id);return e.jsxs("div",{className:"fixed inset-0 bg-white dark:bg-slate-950 z-[60] flex flex-col landscape:flex-row animate-fade-in transition-colors",children:[e.jsx("audio",{ref:r}),e.jsxs("div",{className:"absolute top-0 left-0 w-full flex justify-between items-center p-6 z-30",children:[e.jsx("button",{onClick:D,className:"p-2 bg-gray-100 dark:bg-slate-800 rounded-full text-gray-600 dark:text-slate-300 hover:bg-gray-200 dark:hover:bg-slate-700 transition backdrop-blur-md","aria-label":"Back to library",children:e.jsx(G,{size:24})}),e.jsx("span",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest",children:"Now Playing"}),e.jsx("button",{onClick:s=>w(s,i),className:`p-2 transition hover:scale-110 backdrop-blur-md rounded-full ${t?"text-red-500":"text-gray-400 hover:text-red-400"}`,"aria-label":"Toggle favourite",children:e.jsx(z,{size:24,fill:t?"currentColor":"none"})})]}),e.jsx("div",{className:"flex-1 landscape:w-1/2 flex items-center justify-center p-8 pt-20 landscape:pt-0",children:e.jsxs("div",{className:`w-64 h-64 landscape:w-56 landscape:h-56 rounded-full bg-gradient-to-br ${i.imageGradient} shadow-2xl flex items-center justify-center relative animate-pulse-slow`,children:[e.jsx("div",{className:"absolute inset-4 rounded-full bg-white/20 backdrop-blur-sm border border-white/30"}),e.jsx(S,{size:64,className:"text-white/80 relative z-10"})]})}),e.jsxs("div",{className:"bg-spiritual-50 dark:bg-slate-900 rounded-t-[3rem] landscape:rounded-none landscape:w-1/2 landscape:h-full p-10 shadow-[0_-10px_40px_rgba(0,0,0,0.05)] dark:shadow-[0_-10px_40px_rgba(0,0,0,0.2)] transition-colors flex flex-col justify-center",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-3xl font-serif text-spiritual-900 dark:text-spiritual-100 mb-2",children:i.title}),e.jsx("p",{className:"text-spiritual-500 dark:text-spiritual-400 text-lg",children:i.author})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("input",{type:"range",min:"0",max:v||0,value:b,onChange:F,"aria-label":"Seek progress",className:"w-full h-1.5 bg-spiritual-200 dark:bg-slate-700 rounded-lg appearance-none cursor-pointer [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-4 [&::-webkit-slider-thumb]:h-4 [&::-webkit-slider-thumb]:bg-spiritual-600 [&::-webkit-slider-thumb]:dark:bg-spiritual-400 [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:shadow-md"}),e.jsxs("div",{className:"flex justify-between text-xs text-spiritual-400 dark:text-slate-500 mt-3 font-medium",children:[e.jsx("span",{children:N(b)}),e.jsx("span",{children:N(v)})]})]}),e.jsx("div",{className:"flex items-center justify-center mb-8",children:e.jsx("button",{onClick:V,className:"w-20 h-20 bg-spiritual-800 dark:bg-spiritual-700 text-white rounded-full flex items-center justify-center shadow-xl hover:bg-spiritual-900 dark:hover:bg-spiritual-600 hover:scale-105 transition-all","aria-label":o?"Pause":"Play",children:o?e.jsx(W,{size:28,fill:"white"}):e.jsx(C,{size:28,fill:"white",className:"ml-1"})})}),e.jsxs("div",{className:"flex items-center gap-3 px-4 max-w-xs mx-auto w-full",children:[e.jsx("button",{onClick:$,className:"text-spiritual-400 dark:text-slate-500 hover:text-spiritual-600 dark:hover:text-spiritual-300 transition-colors","aria-label":l?"Unmute":"Mute",children:l||u===0?e.jsx(X,{size:20}):e.jsx(B,{size:20})}),e.jsx("input",{type:"range",min:"0",max:"1",step:"0.05",value:l?0:u,onChange:R,"aria-label":"Volume",className:"flex-1 h-1 bg-spiritual-200 dark:bg-slate-700 rounded-lg appearance-none cursor-pointer [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-3 [&::-webkit-slider-thumb]:h-3 [&::-webkit-slider-thumb]:bg-spiritual-400 [&::-webkit-slider-thumb]:rounded-full"})]})]})]})}return e.jsxs("div",{className:"pb-36 min-h-screen bg-spiritual-50 dark:bg-spiritual-deep animate-fade-in flex flex-col",children:[e.jsxs("div",{className:"p-6 pt-8 pb-12 rounded-b-[3rem] shadow-soft relative z-10 flex flex-col gap-6 bg-gradient-to-br from-indigo-50 via-white to-indigo-100 dark:from-indigo-900 dark:via-spiritual-deep dark:to-indigo-900/10",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("button",{onClick:h,className:"p-3 bg-white dark:bg-white/10 rounded-full shadow-sm hover:scale-105 transition-transform text-spiritual-600 dark:text-spiritual-200","aria-label":"Back",children:e.jsx(H,{size:24})}),e.jsx("div",{className:"w-12"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 rounded-2xl bg-indigo-100/50 dark:bg-indigo-900/30 text-indigo-600 dark:text-indigo-400 shadow-sm backdrop-blur-sm",children:e.jsx(S,{size:32,strokeWidth:1.5})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold text-spiritual-900 dark:text-spiritual-50",children:"Meditation"}),e.jsx("p",{className:"text-spiritual-500 dark:text-spiritual-400 font-medium",children:"Find stillness within"})]})]})]}),e.jsx("div",{className:"flex-1 p-6 max-w-2xl mx-auto w-full relative z-20 space-y-5",children:m.map(t=>{const s=k(t.id);return e.jsxs("div",{onClick:()=>p(t),className:"relative overflow-hidden bg-white dark:bg-spiritual-900/60 p-5 rounded-[2.5rem] shadow-soft border border-spiritual-100 dark:border-spiritual-700/50 flex items-center gap-5 cursor-pointer hover:shadow-lg hover:-translate-y-1 transition-all group",children:[e.jsx("div",{className:`absolute inset-0 opacity-0 group-hover:opacity-10 transition-opacity bg-gradient-to-br ${t.imageGradient}`}),e.jsx("div",{className:`w-20 h-20 rounded-3xl bg-gradient-to-br ${t.imageGradient} flex items-center justify-center flex-shrink-0 shadow-inner relative z-10 shadow-md group-hover:scale-105 transition-transform`,children:e.jsx("div",{className:"bg-white/20 w-10 h-10 rounded-full flex items-center justify-center backdrop-blur-sm",children:e.jsx(C,{size:16,fill:"currentColor",className:"text-spiritual-800/60 ml-0.5"})})}),e.jsxs("div",{className:"flex-1 min-w-0 relative z-10",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-xs font-bold bg-indigo-50 dark:bg-indigo-900/30 text-indigo-600 dark:text-indigo-300 px-2 py-0.5 rounded-lg uppercase tracking-wide",children:t.category}),e.jsxs("div",{className:"flex items-center text-xs text-spiritual-400",children:[e.jsx(I,{size:10,className:"mr-1"})," ",t.duration]})]}),e.jsx("h3",{className:"text-xl font-bold text-spiritual-900 dark:text-spiritual-100 mb-0.5",children:t.title}),e.jsx("p",{className:"text-spiritual-500 dark:text-spiritual-400 text-sm",children:t.author})]}),e.jsx("div",{className:"flex flex-col items-center gap-2 pr-2 relative z-10",children:e.jsx("button",{onClick:n=>w(n,t),className:`p-2 rounded-full transition-colors ${s?"text-red-500 bg-red-50 dark:bg-red-900/20":"text-spiritual-300 dark:text-spiritual-600 hover:text-red-400 hover:bg-spiritual-50 dark:hover:bg-spiritual-800"}`,children:e.jsx(z,{size:20,fill:s?"currentColor":"none"})})})]},t.id)})})]})};export{Q as default};
