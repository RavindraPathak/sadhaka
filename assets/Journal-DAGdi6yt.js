import{r as i,f as J,j as e,e as O,N as P,D as N,h as I,T as j,i as M,B,k as V,U as Z,l as v,m as F,n as _,o as W,q as G}from"./index-2Bv_vk10.js";import{E as H}from"./EmptyState-BNbI6YAl.js";import{P as K}from"./plus-ky2q5cuw.js";import{P as Q}from"./pencil-BO6il0r8.js";const se=({onBack:k,onNavigate:c})=>{const[f,y]=i.useState([]),[C,x]=i.useState(!1),[a,u]=i.useState(null),[p,D]=i.useState("export"),[m,T]=i.useState(""),[h,E]=i.useState(""),d=i.useCallback(()=>{y(J())},[]);i.useEffect(()=>{d()},[d]);const w=()=>{c&&c(v.JOURNAL_EDIT,void 0,{isNested:!0})},S=t=>{c&&c(v.JOURNAL_EDIT,t.id,{isNested:!0})},z=(t,s)=>{t.preventDefault(),t.stopPropagation(),u({title:"Delete Entry?",message:"Are you sure you want to permanently delete this entry?",confirmText:"Delete Entry",onConfirm:()=>{F(s),d()}})},$=()=>{const t=f.filter(b=>{if(!m&&!h)return!0;const o=new Date(b.date).getTime(),g=m?new Date(`${m}T00:00:00.000Z`).getTime():0,A=h?new Date(`${h}T23:59:59.999Z`).getTime():1/0;return o>=g&&o<=A});if(t.length===0){alert("No entries found in the selected date range.");return}const s=_(t);if(!s)return;const r=new Blob([s],{type:"text/csv"}),l=window.URL.createObjectURL(r),n=document.createElement("a");n.href=l,n.download=`sadhaka-journal-${new Date().toISOString().split("T")[0]}.csv`,n.click(),window.URL.revokeObjectURL(l)},L=t=>{var l;const s=(l=t.target.files)==null?void 0:l[0];if(!s)return;const r=new FileReader;r.onload=n=>{var o;const b=(o=n.target)==null?void 0:o.result;if(b){const g=W(b);alert(`Successfully imported ${g} entries.`),d(),x(!1)}},r.readAsText(s)},R=()=>{u({title:"Delete All Entries?",message:"This will permanently remove all journal entries. This action cannot be undone.",confirmText:"Delete Everything",onConfirm:()=>{G(),d(),x(!1)}})},U=t=>{const s=new Date(t),r=s.getUTCDate(),l=s.toLocaleString("default",{month:"short",timeZone:"UTC"});return`${s.toLocaleString("default",{weekday:"short",timeZone:"UTC"})}, ${l} ${r}`},q=t=>{try{const s=JSON.parse(t);if(s&&(s.q1!==void 0||s.q2!==void 0||s.q3!==void 0))return e.jsxs("div",{className:"space-y-3 text-lg font-serif",children:[s.q1&&e.jsx("div",{children:e.jsxs("p",{className:"text-spiritual-800 dark:text-spiritual-200 leading-relaxed italic",children:['"',s.q1,'"']})}),s.q2&&e.jsx("div",{children:e.jsxs("p",{className:"text-spiritual-800 dark:text-spiritual-200 leading-relaxed italic",children:['"',s.q2,'"']})}),s.q3&&e.jsx("div",{children:e.jsxs("p",{className:"text-spiritual-800 dark:text-spiritual-200 leading-relaxed italic",children:['"',s.q3,'"']})})]})}catch{}return e.jsx("p",{className:"text-spiritual-800 dark:text-spiritual-200 line-clamp-3 leading-relaxed mb-4 text-lg font-serif whitespace-pre-wrap",children:t})};return e.jsxs("div",{className:"pb-36 min-h-screen bg-spiritual-50 dark:bg-spiritual-deep flex flex-col",children:[e.jsxs("div",{className:"sticky top-0 z-50 pt-8 pb-4 px-6 rounded-b-[2rem] shadow-soft flex items-center justify-between bg-gradient-to-br from-spiritual-50 via-white to-spiritual-gold/20 dark:from-spiritual-900 dark:via-spiritual-deep dark:to-spiritual-gold/10 backdrop-blur-md",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[k?e.jsx("button",{onClick:k,className:"p-3 bg-white dark:bg-white/10 rounded-full shadow-sm hover:scale-105 transition-transform text-spiritual-600 dark:text-spiritual-200","aria-label":"Back",children:e.jsx(O,{size:20})}):e.jsx("div",{className:"p-3 bg-spiritual-gold/10 rounded-full text-spiritual-600 dark:text-spiritual-400",children:e.jsx(P,{size:24})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-spiritual-900 dark:text-spiritual-50",children:"Chintan"}),e.jsx("p",{className:"text-xs text-spiritual-600 dark:text-spiritual-400 font-bold uppercase tracking-wider",children:"Reflect on your day"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>x(!0),className:"p-3 bg-white dark:bg-white/10 rounded-full shadow-sm text-spiritual-500 hover:text-spiritual-800 dark:text-spiritual-400 dark:hover:text-white transition-colors",title:"Manage Data",children:e.jsx(N,{size:24})}),e.jsx("button",{onClick:w,className:"p-3 bg-white dark:bg-white/10 rounded-full shadow-sm text-spiritual-500 hover:text-spiritual-800 dark:text-spiritual-400 dark:hover:text-white transition-colors",children:e.jsx(K,{size:24})})]})]}),e.jsxs("div",{className:"flex-1 p-6 max-w-2xl mx-auto w-full relative z-20 space-y-6",children:[f.length===0&&e.jsx(H,{icon:e.jsx(Q,{size:32}),message:"No entries yet.",subMessage:"Reflect on your day and log your entry.",actionLabel:"Start writing",onAction:w}),f.map(t=>e.jsxs("div",{onClick:()=>S(t),className:"bg-white dark:bg-spiritual-900/60 p-6 rounded-[2.5rem] shadow-soft border border-spiritual-100 dark:border-spiritual-700/50 hover:shadow-lg transition-all cursor-pointer group",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-spiritual-50 dark:bg-spiritual-800 px-4 py-1.5 rounded-xl text-sm font-bold text-spiritual-600 dark:text-spiritual-300 border border-spiritual-100 dark:border-spiritual-700",children:U(t.date)}),e.jsx("div",{className:"text-xs font-bold uppercase tracking-wider text-spiritual-400",children:t.mood})]}),e.jsx("button",{onClick:s=>z(s,t.id),className:"p-3 text-spiritual-300 hover:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-full transition-colors z-10","aria-label":"Delete entry",children:e.jsx(I,{size:18})})]}),e.jsx("div",{className:"mb-4",children:q(t.text)}),t.learning&&e.jsxs("div",{className:"flex items-start gap-2 text-sm text-spiritual-500 bg-spiritual-50 dark:bg-spiritual-800/50 p-3 rounded-xl mb-3",children:[e.jsx(j,{size:14,className:"mt-0.5"}),e.jsxs("span",{className:"italic",children:['"',t.learning,'"']})]}),t.completedDisciplines&&t.completedDisciplines.length>0&&e.jsx("div",{className:"mt-4 pt-3 border-t border-spiritual-100 dark:border-spiritual-700/50",children:e.jsx("div",{className:"flex flex-wrap gap-2",children:t.completedDisciplines.map((s,r)=>e.jsxs("span",{className:"px-2.5 py-1 bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-300 text-xs font-bold rounded-lg flex items-center gap-1",children:[e.jsx(M,{size:12})," ",s]},r))})})]},t.id))]}),C&&e.jsxs(B,{onClose:()=>x(!1),title:"Data Control",subtitle:"Manage your history",icon:e.jsx(N,{size:24}),children:[e.jsx("div",{className:"flex p-2 mb-6 dark:bg-slate-800 rounded-2xl",children:["export","import","clear"].map(t=>e.jsx("button",{onClick:()=>D(t),className:`flex-1 py-2.5 rounded-xl text-sm font-bold capitalize transition-all ${p===t?"bg-white dark:bg-slate-700 shadow-sm text-spiritual-900 dark:text-spiritual-100":"text-spiritual-400"}`,children:t==="clear"?e.jsx("span",{className:"text-red-400",children:t}):t},t))}),e.jsxs("div",{className:"min-h-[200px]",children:[e.jsxs("div",{className:`space-y-6 ${p==="export"?"animate-fade-in":"hidden"}`,children:[e.jsxs("div",{className:"dark:bg-slate-800/50 p-6 rounded-[2rem]",children:[e.jsx("label",{className:"text-xs font-bold text-spiritual-400 uppercase tracking-wider mb-4 block",children:"Date Range (Optional)"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{className:"text-xs font-bold text-spiritual-300 uppercase ml-1",children:"Start"}),e.jsx("input",{type:"date",value:m,onChange:t=>T(t.target.value),className:"w-full p-3 rounded-xl bg-white dark:bg-slate-900 border border-spiritual-200 dark:border-slate-700 focus:outline-none text-spiritual-800 dark:text-spiritual-200"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{className:"text-xs font-bold text-spiritual-300 uppercase ml-1",children:"End"}),e.jsx("input",{type:"date",value:h,onChange:t=>E(t.target.value),className:"w-full p-3 rounded-xl bg-white dark:bg-slate-900 border border-spiritual-200 dark:border-slate-700 focus:outline-none text-spiritual-800 dark:text-spiritual-200"})]})]})]}),e.jsxs("button",{onClick:$,className:"w-full py-4 bg-spiritual-800 dark:bg-spiritual-700 text-white rounded-2xl font-bold flex items-center justify-center gap-2 hover:scale-[1.02] active:scale-95 transition-all shadow-lg",children:[e.jsx(V,{size:20})," Download CSV"]})]}),e.jsxs("div",{className:`space-y-6 text-center py-4 ${p==="import"?"animate-fade-in":"hidden"}`,children:[e.jsx("div",{className:"w-20 h-20 bg-spiritual-50 dark:bg-slate-800 rounded-full flex items-center justify-center mx-auto",children:e.jsx(Z,{size:32,className:"text-spiritual-400"})}),e.jsx("p",{className:"text-spiritual-500 dark:text-spiritual-400 px-4",children:"Restore entries from a previously exported CSV."}),e.jsxs("label",{className:"block w-full py-4 bg-spiritual-100 dark:bg-slate-800 text-spiritual-800 dark:text-spiritual-100 rounded-2xl font-bold cursor-pointer hover:bg-spiritual-200 transition-colors",children:["Choose File",e.jsx("input",{type:"file",accept:".csv",className:"hidden",onChange:L})]})]}),e.jsxs("div",{className:`space-y-6 text-center py-4 ${p==="clear"?"animate-fade-in":"hidden"}`,children:[e.jsx("div",{className:"w-20 h-20 bg-red-50 dark:bg-red-900/20 rounded-full flex items-center justify-center mx-auto animate-pulse",children:e.jsx(j,{size:32,className:"text-red-500"})}),e.jsx("p",{className:"text-red-500/80 px-4 font-medium",children:"Warning: This will permanently delete all journal entries."}),e.jsx("button",{onClick:R,className:"w-full py-4 bg-red-500 text-white rounded-2xl font-bold hover:bg-red-600 transition-colors shadow-lg shadow-red-500/20",children:"Delete Everything"})]})]})]}),a&&e.jsx("div",{className:"fixed inset-0 bg-spiritual-deep/80 backdrop-blur-md z-[70] flex items-center justify-center p-4 animate-fade-in",children:e.jsxs("div",{className:"bg-white dark:bg-spiritual-900 w-full max-w-sm rounded-[2.5rem] p-8 shadow-2xl border border-white/10",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:`w-16 h-16 ${a.confirmText.toLowerCase().includes("delete")?"bg-red-50 dark:bg-red-900/20":"bg-amber-50 dark:bg-amber-900/20"} rounded-full flex items-center justify-center mx-auto mb-6`,children:e.jsx(j,{size:32,className:`${a.confirmText.toLowerCase().includes("delete")?"text-red-500":"text-amber-500"}`})}),e.jsx("h3",{className:"text-2xl font-bold text-spiritual-900 dark:text-spiritual-100 mb-2",children:a.title}),e.jsx("p",{className:"text-spiritual-500 dark:text-spiritual-400 mb-8",children:a.message})]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("button",{onClick:()=>{a.onConfirm(),u(null)},className:`w-full py-4 text-white rounded-2xl font-bold transition-colors ${a.confirmText.toLowerCase().includes("delete")?"bg-red-500 hover:bg-red-600":"bg-spiritual-800 hover:bg-spiritual-900"}`,children:a.confirmText}),e.jsx("button",{onClick:()=>u(null),className:"w-full py-3 text-spiritual-500 dark:text-spiritual-400 font-bold hover:bg-spiritual-100 dark:hover:bg-spiritual-800 rounded-2xl transition-colors",children:"Cancel"})]})]})})]})};export{se as default};
