import{h as fe,a as ge,D as me,k as be,l as we,m as ye,n as ke,o as ve,q as je,c as Ne,j as e,r as qe,v as Se,M as Te,b as Ce,d as De,w as Ee}from"./index-Cc3QSN8n.js";import{r as i}from"./vendor-DDTLr4RV.js";import{a1 as Re,O as ze,ao as Me,S as V,d as Ae,ae as We,ap as Le,x as Ie,aq as Pe,a7 as Y,Y as Fe}from"./utils-kLxd5vEQ.js";const G=["Did your actions today match your morning resolve?","Where did you hesitate to speak your truth?","Was your 'Yes' truly a 'Yes' today?","Did you negotiate with your discipline?","What is the one thing you are hiding from yourself?","Did you act out of conviction or convenience?","Were you a master of your senses or a slave to them?","Did you honour the time given to you today?"],Oe=["Who triggered you today, and why?","Did you listen to understand, or to reply?","Was it your Ego speaking, or your Self?","Did you react impulsively or respond consciously?","Where did you lose your patience?","Did you judge someone too quickly today?","Were you kind even when it was difficult?","Did you hold onto a grudge or let it flow?"],$e=["Whose burden did you lighten today?","Did you smile with your eyes?","Is your heart lighter than it was this morning?","What unexpected blessing did you receive?","Did you see the Divine in another?","How much of 'yourself' did you give away?","Are you carrying yesterday's dust into tonight's sleep?","Did you pause to appreciate beauty today?"],He=a=>{let n=[];switch(a){case"q1":n=G;break;case"q2":n=Oe;break;case"q3":n=$e;break;default:n=G}const w=Math.floor(Math.random()*n.length);return n[w]},Ke=()=>{const[a,n]=i.useState(!1),[w,x]=i.useState(""),[M,A]=i.useState(!1),d=i.useRef(null),c=i.useRef(null);i.useEffect(()=>{if(typeof window<"u"&&("webkitSpeechRecognition"in window||"SpeechRecognition"in window)){A(!0);const y=window.SpeechRecognition||window.webkitSpeechRecognition,r=new y;r.continuous=!0,r.interimResults=!1,r.lang="en-US";const p=()=>{c.current&&clearTimeout(c.current),c.current=setTimeout(()=>{r.stop()},5e3)};r.onstart=()=>{p()},r.onresult=o=>{p();let u="";for(let h=o.resultIndex;h<o.results.length;++h)o.results[h].isFinal&&(u+=o.results[h][0].transcript);u.trim()&&x(h=>h+(h?" ":"")+u.trim())},r.onerror=o=>{o.error!=="no-speech"&&console.error("Speech recognition error",o.error),n(!1),c.current&&clearTimeout(c.current)},r.onend=()=>{n(!1),c.current&&clearTimeout(c.current)},d.current=r}return()=>{c.current&&clearTimeout(c.current)}},[]);const b=i.useCallback(()=>{if(d.current&&!a){x("");try{d.current.start(),n(!0)}catch(y){console.error("Failed to start recognition:",y)}}},[a]),N=i.useCallback(()=>{d.current&&a&&(d.current.stop(),n(!1))},[a]),f=i.useCallback(()=>{a?N():b()},[a,b,N]);return{isListening:a,transcript:w,resetTranscript:()=>x(""),toggleListening:f,isSupported:M}},Ue="Did I fulfil my intention? What is my honest confession to my Guru?",Be="How were my reactions today, what did I learn from my interactions?",_e="How is my spiritual bank balance, Did I make people smile today?",K=()=>{const a=new Date;return new Date(a.getTime()-a.getTimezoneOffset()*6e4).toISOString().split("T")[0]},Ye=({onClose:a,initialEntryId:n,initialDate:w})=>{const{showToast:x}=fe(),{preferences:M}=ge(),A=M.location||me,[d,c]=i.useState(w||K()),[b,N]=i.useState(n||null),[f,y]=i.useState(null),[r,p]=i.useState({q1:"",q2:"",q3:""}),[o,u]=i.useState("q1"),[h,Z]=i.useState([]),[q,D]=i.useState([]),[X,W]=i.useState(!1),[ee,U]=i.useState(!1),[k,te]=i.useState(!1),[L,I]=i.useState({text:"",visible:!1}),P=i.useRef(null),S=i.useRef({q1:null,q2:null,q3:null}),F=i.useRef(0),{isListening:O,transcript:T,resetTranscript:B,toggleListening:se,isSupported:ie}=Ke();i.useEffect(()=>{Z(be())},[]);const g=t=>{const s=S.current[t];s&&(F.current=s.selectionStart,u(t))};i.useEffect(()=>{if(T){const t=r[o],s=F.current,m=t.substring(0,s),l=t.substring(s),j=m.length>0&&!m.endsWith(" ")&&!m.endsWith(`
`)&&!T.startsWith(" ")?" ":"",pe=m+j+T+l,he=s+j.length+T.length;p(xe=>({...xe,[o]:pe})),F.current=he,B()}},[T,B,o,r]);const[C,$]=i.useState(null),v=new Date(d);v.setHours(12,0,0,0);const E=we(v),R=ye(v),re=ke(v),_=ve(v,A.timezone),J=je(v),H=(t,s)=>{const m=Ce();let l=s?m.find(j=>j.id===s):m.find(j=>j.date.split("T")[0]===t);l?(c(l.date.split("T")[0]),N(l.id),y(l.mood),p({q1:l.q1||"",q2:l.q2||"",q3:l.q3||""}),D([])):(c(t),N(null),y(null),p({q1:"",q2:"",q3:""}),D([]))};i.useEffect(()=>{n?H("",n):H(w||K())},[n,w]);const ae=t=>{H(t)},z=()=>{D(t=>[...t,{...r}])},ne=()=>{if(q.length===0)return;const t=q[q.length-1];p(t),D(s=>s.slice(0,-1))},oe=()=>{if(!f){x("Please select your mood (The Ankush)","error"),U(!0),setTimeout(()=>U(!1),800);return}if(!Object.values(r).some(l=>l.trim().length>0)){x("Please write your reflections before saving.","error");return}const s=h.filter(l=>l.completedDates.includes(d)).map(l=>l.title),m={id:b||Date.now().toString(),date:new Date(`${d}T00:00:00.000Z`).toISOString(),mood:f,q1:r.q1,q2:r.q2,q3:r.q3,completedDisciplines:s,panchang:{tithi:`${E.name} (${E.type})`,moonPhase:re.phase,vaar:_,maasa:J.name,specialDay:R?R.name:void 0},tags:[],reaction:"neutral",madeSomeoneSmile:!1,learning:""};Ee(m),x("Journal saved"),a()},le=()=>{P.current&&clearTimeout(P.current);const t=He(o);I({text:"",visible:!1}),requestAnimationFrame(()=>{I({text:t,visible:!0})}),P.current=setTimeout(()=>{I(s=>({...s,visible:!1}))},4e3)},ce=()=>{b&&$({title:"Delete Entry?",message:"This action cannot be undone.",confirmText:"Delete",onConfirm:()=>{De(b),x("Entry deleted","info"),a()}})},de=()=>{const t=!k;te(t),t&&setTimeout(()=>{const s=S.current[o];s&&s.focus()},50)},Q=h.filter(t=>t.completedDates.includes(d)),{rootColor:ue}=Ne(f||"");return e.jsxs("div",{className:"fixed inset-0 z-[60] bg-spiritual-50 dark:bg-spiritual-deep flex flex-col animate-fade-in overflow-hidden",children:[e.jsxs("div",{className:"sticky top-0 z-50 pt-8 pb-4 px-6 rounded-b-[2rem] shadow-soft flex items-center justify-between bg-gradient-to-br from-spiritual-50 via-white to-spiritual-gold/20 dark:from-spiritual-900 dark:via-spiritual-deep dark:to-spiritual-gold/10 backdrop-blur-md",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:a,className:"p-2.5 bg-white dark:bg-white/10 rounded-full shadow-sm hover:scale-105 transition-transform text-spiritual-600 dark:text-spiritual-200","aria-label":"Back",children:e.jsx(Re,{size:20})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-spiritual-900 dark:text-spiritual-50",children:b?"Edit Entry":"New Entry"}),e.jsx("p",{className:"text-xs text-spiritual-600 dark:text-spiritual-400 font-bold uppercase tracking-wider",children:"Capture your thoughts"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[b&&e.jsx("button",{onClick:ce,className:"p-2.5 bg-white dark:bg-white/10 rounded-full shadow-sm text-spiritual-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/10 transition-colors",title:"Delete Entry",children:e.jsx(ze,{size:20})}),e.jsxs("button",{onClick:oe,className:"px-4 py-2 bg-spiritual-800 dark:bg-spiritual-100 text-white dark:text-spiritual-900 rounded-full font-bold shadow-md hover:scale-105 active:scale-95 transition-all flex items-center gap-2",children:[e.jsx(Me,{size:18}),e.jsx("span",{className:"hidden sm:inline",children:"Save"})]})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto px-6 pb-40",children:e.jsxs("div",{className:"max-w-2xl mx-auto pt-4 space-y-8",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("input",{type:"date",value:d,onChange:t=>{const s=t.target.value;s>K()&&x("Future date selected","info"),ae(s)},className:"bg-transparent border-none text-sm font-bold text-spiritual-400 uppercase tracking-widest focus:outline-none focus:text-spiritual-600 dark:focus:text-spiritual-200"}),e.jsxs("div",{className:"flex flex-col gap-1 mt-1",children:[e.jsxs("h2",{className:"text-xl font-serif font-bold text-spiritual-900 dark:text-spiritual-100 flex items-center gap-2 flex-wrap",children:[E.name," ",e.jsx("span",{className:"text-sm font-normal text-spiritual-500 dark:text-spiritual-400",children:E.type==="Shukla"?"• Waxing":"• Waning"})]}),e.jsxs("div",{className:"flex flex-wrap gap-x-3 text-sm text-spiritual-500 dark:text-spiritual-400 font-medium",children:[e.jsx("span",{className:"text-spiritual-800 dark:text-spiritual-200",children:_}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:[J.name," Maasa"]})]}),R&&e.jsxs("div",{className:"text-amber-600 dark:text-amber-400 font-bold flex items-center gap-1.5 mt-1 animate-pulse-slow",children:[e.jsx(V,{size:14})," ",R.name]})]})]}),Q.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-bold text-spiritual-400 uppercase tracking-widest mb-2",children:"Accomplished Today"}),e.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 -mx-6 px-6 scrollbar-hide",children:Q.map(t=>e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 rounded-xl text-xs font-bold whitespace-nowrap bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300 border border-green-200 dark:border-green-800",children:[e.jsx(Ae,{size:12,strokeWidth:4}),t.title]},t.id))})]}),e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"space-y-3",onClick:()=>u("q1"),children:[e.jsx("p",{className:"text-spiritual-900 dark:text-spiritual-100 font-bold text-lg leading-snug",children:Ue}),e.jsx("textarea",{ref:t=>{S.current.q1=t},value:r.q1,onChange:t=>{p(s=>({...s,q1:t.target.value})),z()},onFocus:()=>u("q1"),onSelect:()=>g("q1"),onClick:()=>g("q1"),onKeyUp:()=>g("q1"),inputMode:k?"text":"none",placeholder:"Reflect here...",className:`w-full min-h-[140px] p-5 rounded-2xl resize-none text-base leading-relaxed font-serif transition-colors
                                bg-white dark:bg-white/5 
                                text-spiritual-800 dark:text-spiritual-200 
                                placeholder:text-spiritual-300 dark:placeholder:text-white/20
                                border border-spiritual-100 dark:border-white/10
                                focus:outline-none focus:ring-2 focus:ring-spiritual-200 dark:focus:ring-white/10
                                ${o==="q1"?"ring-2 ring-spiritual-200 dark:ring-white/10":""}
                            `})]}),e.jsxs("div",{className:"space-y-3",onClick:()=>u("q2"),children:[e.jsx("p",{className:"text-spiritual-900 dark:text-spiritual-100 font-bold text-lg leading-snug",children:Be}),e.jsx("textarea",{ref:t=>{S.current.q2=t},value:r.q2,onChange:t=>{p(s=>({...s,q2:t.target.value})),z()},onFocus:()=>u("q2"),onSelect:()=>g("q2"),onClick:()=>g("q2"),onKeyUp:()=>g("q2"),inputMode:k?"text":"none",placeholder:"Reflect here...",className:`w-full min-h-[140px] p-5 rounded-2xl resize-none text-base leading-relaxed font-serif transition-colors
                                bg-white dark:bg-white/5 
                                text-spiritual-800 dark:text-spiritual-200 
                                placeholder:text-spiritual-300 dark:placeholder:text-white/20
                                border border-spiritual-100 dark:border-white/10
                                focus:outline-none focus:ring-2 focus:ring-spiritual-200 dark:focus:ring-white/10
                                ${o==="q2"?"ring-2 ring-spiritual-200 dark:ring-white/10":""}
                            `})]}),e.jsxs("div",{className:"space-y-3",onClick:()=>u("q3"),children:[e.jsx("p",{className:"text-spiritual-900 dark:text-spiritual-100 font-bold text-lg leading-snug",children:_e}),e.jsx("textarea",{ref:t=>{S.current.q3=t},value:r.q3,onChange:t=>{p(s=>({...s,q3:t.target.value})),z()},onFocus:()=>u("q3"),onSelect:()=>g("q3"),onClick:()=>g("q3"),onKeyUp:()=>g("q3"),inputMode:k?"text":"none",placeholder:"Reflect here...",className:`w-full min-h-[140px] p-5 rounded-2xl resize-none text-base leading-relaxed font-serif transition-colors
                                bg-white dark:bg-white/5 
                                text-spiritual-800 dark:text-spiritual-200 
                                placeholder:text-spiritual-300 dark:placeholder:text-white/20
                                border border-spiritual-100 dark:border-white/10
                                focus:outline-none focus:ring-2 focus:ring-spiritual-200 dark:focus:ring-white/10
                                ${o==="q3"?"ring-2 ring-spiritual-200 dark:ring-white/10":""}
                            `})]})]})]})}),e.jsx("div",{className:`absolute bottom-28 left-0 right-0 z-40 flex justify-center pointer-events-none transition-all duration-1000 ${L.visible?"opacity-100 translate-y-0":"opacity-0 translate-y-4"}`,children:e.jsx("div",{className:"bg-spiritual-900/90 dark:bg-white/90 backdrop-blur-md px-6 py-3 rounded-2xl shadow-xl max-w-sm text-center transform hover:scale-105 transition-transform",children:e.jsx("p",{className:"text-spiritual-100 dark:text-spiritual-900 font-serif italic text-lg leading-relaxed",children:L.text})})}),e.jsx("div",{className:"absolute bottom-8 left-0 right-0 flex justify-center items-end gap-4 pointer-events-none z-50",children:e.jsxs("div",{className:"glass dark:bg-spiritual-900/90 backdrop-blur-xl p-2 rounded-full shadow-lg pointer-events-auto flex items-center gap-2 border border-white/20",children:[e.jsx("button",{onClick:ne,disabled:q.length===0,className:`p-4 rounded-full transition-all ${q.length===0?"text-spiritual-300 dark:text-white/20":"bg-spiritual-100 dark:bg-white/10 text-spiritual-600 dark:text-spiritual-200 hover:scale-105 active:scale-95"}`,title:"Undo",children:e.jsx(We,{size:24})}),e.jsx("button",{onClick:le,className:"p-4 rounded-full bg-spiritual-100 dark:bg-white/10 text-spiritual-600 dark:text-spiritual-200 hover:bg-spiritual-200 dark:hover:bg-white/20 transition-all hover:scale-105 active:scale-95",title:"Whisper a thought...",children:e.jsx(V,{size:24,className:L.visible?"animate-pulse text-amber-500":""})}),ie&&e.jsx("button",{onClick:()=>{O||(qe(),Se(),z()),se()},className:`p-4 rounded-full transition-all hover:scale-105 active:scale-95 shadow-md ${O?"bg-red-500 text-white animate-pulse":"bg-spiritual-800 dark:bg-spiritual-100 text-white dark:text-spiritual-900"}`,title:"Voice Dictation",children:O?e.jsx(Le,{size:24}):e.jsx(Ie,{size:24})}),e.jsx("button",{onClick:de,className:`p-4 rounded-full transition-all hover:scale-105 active:scale-95 shadow-md ${k?"bg-spiritual-800 dark:bg-spiritual-100 text-white dark:text-spiritual-900":"bg-spiritual-100 dark:bg-white/10 text-spiritual-600 dark:text-spiritual-200"}`,title:k?"Hide Keyboard":"Show Keyboard (Type)",children:e.jsx(Pe,{size:24})}),e.jsx("button",{onClick:()=>W(!0),className:`p-4 rounded-full transition-all hover:scale-105 active:scale-95 flex items-center justify-center border-2 
                        ${ee?"animate-bounce border-red-400 bg-red-100":""}
                        ${f?"bg-white/5 border-transparent":"bg-spiritual-100 dark:bg-white/10 border-transparent text-spiritual-600 dark:text-spiritual-200"}
                    `,style:f?{backgroundColor:ue,color:"#FFF"}:{},title:"Set Mood",children:f?e.jsx(Y,{size:24,fill:"currentColor"}):e.jsx(Y,{size:24})})]})}),X&&e.jsx(Te,{initialMood:f,onSelect:t=>{y(t),W(!1)},onClose:()=>W(!1)}),C&&e.jsx("div",{className:"fixed inset-0 bg-spiritual-deep/80 backdrop-blur-md z-[80] flex items-center justify-center p-4 animate-fade-in",children:e.jsxs("div",{className:"bg-white dark:bg-spiritual-900 w-full max-w-sm rounded-[2.5rem] p-8 shadow-2xl border border-white/10 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-amber-50 dark:bg-amber-900/20 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(Fe,{size:32,className:"text-amber-500"})}),e.jsx("h3",{className:"text-2xl font-bold text-spiritual-900 dark:text-spiritual-100 mb-2",children:C.title}),e.jsx("p",{className:"text-spiritual-500 dark:text-spiritual-400 mb-8",children:C.message}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("button",{onClick:()=>{C.onConfirm(),$(null)},className:"w-full py-4 bg-spiritual-800 dark:bg-spiritual-100 text-white dark:text-spiritual-900 rounded-2xl font-bold transition-transform active:scale-95",children:C.confirmText}),e.jsx("button",{onClick:()=>$(null),className:"w-full py-3 text-spiritual-500 font-bold transition-colors hover:text-spiritual-800 dark:hover:text-white",children:"Cancel"})]})]})})]})};export{Ye as default};
