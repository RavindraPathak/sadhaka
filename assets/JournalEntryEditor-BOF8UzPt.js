import{v as de,r as s,w as ue,a as pe,x as he,y as fe,z as me,E as xe,F as ge,G as be,J as we,f as _,K as ke,j as e,e as ye,h as ve,S as G,L as je,R as Te,M as Se,O as J,Q as Ne,T as Ce,m as q,Y as De}from"./index-4hpc5m_x.js";/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Me=[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M16.95 16.95A7 7 0 0 1 5 12v-2",key:"cqa7eg"}],["path",{d:"M18.89 13.23A7 7 0 0 0 19 12v-2",key:"16hl24"}],["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}]],Ie=de("mic-off",Me),Re=["What is my Sankalp (intention) for today?","How can I serve others today?","What quality of the Divine do I wish to embody today?","What am I grateful for as I wake up?","Today, I will practice mindfulness by...","What is one thing I can let go of today?","Who needs my love and patience today?","If today was my last day, how would I live it?"],We=["Where did I lose my awareness today?","Did I act out of ego or love in my interactions?","What was the most beautiful moment of today?","What lesson did my challenges teach me?","Did I stay true to my Sankalp today?","Who did I help today?","What am I holding onto that I can release before sleep?","How did I nurture my body and soul today?"],Q=["In this moment, I am feeling...","The silence is telling me...","What is preventing me from being fully present?","I feel closest to the Divine when...","What fear is holding me back?","My breath feels...","Focus on the space between thoughts.","Reflect on a recent reaction. Was it conscious or compulsive?"],Ae=()=>{const a=new Date().getHours();let r=Q;a>=5&&a<12?r=Re:(a>=18||a<5)&&(r=We),Math.random()>.7&&(r=[...r,...Q]);const h=Math.floor(Math.random()*r.length);return r[h]},Pe=()=>{const[a,r]=s.useState(!1),[h,j]=s.useState(""),[W,f]=s.useState(!1),x=s.useRef(null),i=s.useRef(null);s.useEffect(()=>{if(typeof window<"u"&&("webkitSpeechRecognition"in window||"SpeechRecognition"in window)){f(!0);const C=window.SpeechRecognition||window.webkitSpeechRecognition,d=new C;d.continuous=!0,d.interimResults=!0,d.lang="en-US";const b=()=>{i.current&&clearTimeout(i.current),i.current=setTimeout(()=>{d.stop()},5e3)};d.onstart=()=>{b()},d.onresult=u=>{b();let T="";for(let p=u.resultIndex;p<u.results.length;++p)u.results[p].isFinal&&(T+=u.results[p][0].transcript);T&&j(p=>p+(p?" ":"")+T)},d.onerror=u=>{console.error("Speech recognition error",u.error),r(!1),i.current&&clearTimeout(i.current)},d.onend=()=>{r(!1),i.current&&clearTimeout(i.current)},x.current=d}return()=>{i.current&&clearTimeout(i.current)}},[]);const k=s.useCallback(()=>{x.current&&!a&&(j(""),x.current.start(),r(!0))},[a]),l=s.useCallback(()=>{x.current&&a&&(x.current.stop(),r(!1))},[a]),g=s.useCallback(()=>{a?l():k()},[a,k,l]);return{isListening:a,transcript:h,resetTranscript:()=>j(""),toggleListening:g,isSupported:W}},B="Did I fulfil my intention? What is my honest confession to my Guru?",K="How were my reactions today, what did I learn from my interactions?",Y="How is my spiritual bank balance, Did I make people smile today?",V=`**${B}**
...

**${K}**
...

**${Y}**
...
`,z=()=>{const a=new Date;return new Date(a.getTime()-a.getTimezoneOffset()*6e4).toISOString().split("T")[0]},Ee=({onClose:a,initialEntryId:r})=>{const{showToast:h}=ue(),{preferences:j}=pe(),W=j.location||he,[f,x]=s.useState(z()),[i,k]=s.useState(null),[l,g]=s.useState(""),[C,d]=s.useState([]),[b,u]=s.useState([]),[T,p]=s.useState(!1),[Z,E]=s.useState(!1),[L,X]=s.useState(null),c=s.useRef(null),w=s.useRef(0),{isListening:A,transcript:S,resetTranscript:O,toggleListening:ee,isSupported:te}=Pe();s.useEffect(()=>{d(fe())},[]);const D=()=>{c.current&&(w.current=c.current.selectionStart)};s.useEffect(()=>{if(S){const t=w.current,n=l,o=n.substring(0,t),m=n.substring(t),v=o.length>0&&!o.endsWith(" ")&&!o.endsWith(`
`)&&!S.startsWith(" ")?" ":"",ce=o+v+S+m,P=t+v.length+S.length;g(ce),w.current=P,O(),requestAnimationFrame(()=>{c.current&&(c.current.setSelectionRange(P,P),c.current.blur(),c.current.focus())})}},[S,O,l]);const[N,M]=s.useState(null),y=new Date(f);y.setHours(12,0,0,0);const I=me(y),R=xe(y),se=ge(y),F=be(y,W.timezone),$=we(y);s.useEffect(()=>{if(r){const n=_().find(o=>o.id===r);n&&(x(n.date.split("T")[0]),k(n.mood),g(n.text),w.current=n.text.length,u([]))}else g(V),x(z()),k(null),u([]),w.current=V.length},[r]),s.useEffect(()=>{if(!r){const n=_().find(o=>o.date.split("T")[0]===f);X(n||null)}},[f,r]);const H=()=>{u(t=>[...t,l])},ne=()=>{if(b.length===0)return;const t=b[b.length-1];g(t),u(n=>n.slice(0,-1)),w.current=t.length},re=t=>{let n=t;return[B,K,Y,"...","**"].forEach(m=>{n=n.split(m).join("")}),n.trim().length>=3},ae=()=>{if(!i){h("Please select your mood (The Ankush)","error"),E(!0),setTimeout(()=>E(!1),800);return}if(!re(l)){h("Please write your reflections before saving.","error");return}const t=()=>{const n=C.filter(m=>m.completedDates.includes(f)).map(m=>m.title),o={id:r||Date.now().toString(),date:new Date(`${f}T00:00:00.000Z`).toISOString(),mood:i,text:l,completedDisciplines:n,panchang:{tithi:`${I.name} (${I.type})`,moonPhase:se.phase,vaar:F,maasa:$.name,specialDay:R?R.name:void 0},tags:[],reaction:"neutral",madeSomeoneSmile:!1,learning:""};De(o),h("Journal saved"),a()};if(L){M({title:"Overwrite Entry?",message:`An entry for ${f} already exists. Do you want to replace it?`,confirmText:"Yes, Replace",onConfirm:()=>{q(L.id),t()}});return}t()},ie=()=>{H();const t=Ae(),o=`${l.length>0&&!l.endsWith(`

`)?l.endsWith(`
`)?`
`:`

`:""}**${t}**
...`,m=l+o;g(m);const v=m.length;w.current=v,requestAnimationFrame(()=>{c.current&&(c.current.focus(),c.current.setSelectionRange(v,v),c.current.scrollTop=c.current.scrollHeight)})},oe=()=>{r&&M({title:"Delete Entry?",message:"This action cannot be undone.",confirmText:"Delete",onConfirm:()=>{q(r),h("Entry deleted","info"),a()}})},U=C.filter(t=>t.completedDates.includes(f)),{rootColor:le}=ke(i||"");return e.jsxs("div",{className:"fixed inset-0 z-[60] bg-spiritual-50 dark:bg-spiritual-deep flex flex-col animate-fade-in overflow-hidden",children:[e.jsxs("div",{className:"sticky top-0 z-50 pt-8 pb-2 px-6 flex items-center justify-between bg-spiritual-50/90 dark:bg-spiritual-deep/90 backdrop-blur-md",children:[e.jsx("button",{onClick:a,className:"p-3 -ml-3 text-spiritual-500 hover:text-spiritual-900 dark:text-spiritual-400 dark:hover:text-spiritual-100 transition-colors","aria-label":"Back",children:e.jsx(ye,{size:24})}),e.jsxs("div",{className:"flex gap-2",children:[r&&e.jsx("button",{onClick:oe,className:"p-3 text-spiritual-400 hover:text-red-500 transition-colors rounded-full hover:bg-red-50 dark:hover:bg-red-900/10",title:"Delete Entry",children:e.jsx(ve,{size:24})}),e.jsx("button",{onClick:ae,className:"p-3 text-spiritual-600 dark:text-spiritual-300 hover:text-spiritual-900 dark:hover:text-white font-bold transition-colors",children:"Save"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto px-6 pb-32",children:e.jsxs("div",{className:"max-w-2xl mx-auto pt-4 space-y-6",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("input",{type:"date",value:f,onChange:t=>{const n=t.target.value;x(n);const o=z();n>o?h("Future date selected","info"):n<o&&h("Past date selected","info")},className:"bg-transparent border-none text-sm font-bold text-spiritual-400 uppercase tracking-widest focus:outline-none focus:text-spiritual-600 dark:focus:text-spiritual-200"}),e.jsxs("div",{className:"flex flex-col gap-1 mt-1",children:[e.jsxs("h2",{className:"text-xl font-serif font-bold text-spiritual-900 dark:text-spiritual-100 flex items-center gap-2 flex-wrap",children:["On today's day - ",I.name,e.jsx("span",{className:"text-sm font-normal text-spiritual-500 dark:text-spiritual-400",children:I.type==="Shukla"?"• Waxing":"• Waning"})]}),e.jsxs("div",{className:"flex flex-wrap gap-x-3 text-sm text-spiritual-500 dark:text-spiritual-400 font-medium",children:[e.jsx("span",{className:"text-spiritual-800 dark:text-spiritual-200",children:F}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:[$.name," Maasa"]})]}),R&&e.jsxs("div",{className:"text-amber-600 dark:text-amber-400 font-bold flex items-center gap-1.5 mt-1 animate-pulse-slow",children:[e.jsx(G,{size:14})," ",R.name]})]})]}),U.length>0?e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-bold text-spiritual-400 uppercase tracking-widest mb-2",children:"Accomplished Today"}),e.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 -mx-6 px-6 scrollbar-hide",children:U.map(t=>e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 rounded-xl text-xs font-bold whitespace-nowrap bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300 border border-green-200 dark:border-green-800",children:[e.jsx(je,{size:12,strokeWidth:4}),t.title]},t.id))})]}):null,e.jsx("textarea",{ref:c,value:l,onChange:t=>{g(t.target.value),D()},onClick:D,onSelect:D,onKeyUp:D,placeholder:"Start writing...",className:"w-full h-[60vh] bg-transparent border-none resize-none focus:outline-none text-lg leading-loose text-spiritual-800 dark:text-spiritual-200 placeholder:text-spiritual-300/50 font-serif whitespace-pre-wrap",autoFocus:!r})]})}),e.jsx("div",{className:"absolute bottom-8 left-0 right-0 flex justify-center items-end gap-4 pointer-events-none z-50",children:e.jsxs("div",{className:"glass dark:bg-spiritual-900/90 backdrop-blur-xl p-2 rounded-full shadow-lg pointer-events-auto flex items-center gap-2 border border-white/20",children:[e.jsx("button",{onClick:ne,disabled:b.length===0,className:`p-4 rounded-full transition-all ${b.length===0?"text-spiritual-300 dark:text-white/20":"bg-spiritual-100 dark:bg-white/10 text-spiritual-600 dark:text-spiritual-200 hover:scale-105 active:scale-95"}`,title:"Undo",children:e.jsx(Te,{size:24})}),e.jsx("button",{onClick:ie,className:"p-4 rounded-full bg-spiritual-100 dark:bg-white/10 text-spiritual-600 dark:text-spiritual-200 hover:bg-spiritual-200 dark:hover:bg-white/20 transition-all hover:scale-105 active:scale-95",title:"Get Prompt",children:e.jsx(G,{size:24})}),te&&e.jsx("button",{onClick:()=>{A||H(),ee()},className:`p-4 rounded-full transition-all hover:scale-105 active:scale-95 shadow-md ${A?"bg-red-500 text-white animate-pulse":"bg-spiritual-800 dark:bg-spiritual-100 text-white dark:text-spiritual-900"}`,title:"Voice Dictation",children:A?e.jsx(Ie,{size:24}):e.jsx(Se,{size:24})}),e.jsx("button",{onClick:()=>p(!0),className:`p-4 rounded-full transition-all hover:scale-105 active:scale-95 flex items-center justify-center border-2 
                        ${Z?"animate-bounce border-red-400 bg-red-100":""}
                        ${i?"bg-white/5 border-transparent":"bg-spiritual-100 dark:bg-white/10 border-transparent text-spiritual-600 dark:text-spiritual-200"}
                    `,style:i?{backgroundColor:le,color:"#FFF"}:{},title:"Set Mood (The Ankush)",children:i?e.jsx(J,{size:24,fill:"currentColor"}):e.jsx(J,{size:24})})]})}),T&&e.jsx(Ne,{initialMood:i,onSelect:t=>{k(t),p(!1)},onClose:()=>p(!1)}),N&&e.jsx("div",{className:"fixed inset-0 bg-spiritual-deep/80 backdrop-blur-md z-[80] flex items-center justify-center p-4 animate-fade-in",children:e.jsxs("div",{className:"bg-white dark:bg-spiritual-900 w-full max-w-sm rounded-[2.5rem] p-8 shadow-2xl border border-white/10 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-amber-50 dark:bg-amber-900/20 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(Ce,{size:32,className:"text-amber-500"})}),e.jsx("h3",{className:"text-2xl font-bold text-spiritual-900 dark:text-spiritual-100 mb-2",children:N.title}),e.jsx("p",{className:"text-spiritual-500 dark:text-spiritual-400 mb-8",children:N.message}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("button",{onClick:()=>{N.onConfirm(),M(null)},className:"w-full py-4 bg-spiritual-800 dark:bg-spiritual-100 text-white dark:text-spiritual-900 rounded-2xl font-bold transition-transform active:scale-95",children:N.confirmText}),e.jsx("button",{onClick:()=>M(null),className:"w-full py-3 text-spiritual-500 font-bold transition-colors hover:text-spiritual-800 dark:hover:text-white",children:"Cancel"})]})]})})]})};export{Ee as default};
