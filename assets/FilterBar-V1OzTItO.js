import{u as y,a as I,p as T,s as $,j as e}from"./index-CcJyzQ7H.js";import{r as i}from"./vendor-DDTLr4RV.js";import{r as P,ai as R,s as B,t as L,ak as O,P as F}from"./utils-CwGoM2ch.js";const K=(n,o,c)=>{const{library:l}=y(),h=i.useRef(null),d=l.ambientSounds;return i.useEffect(()=>{const s=new Audio;return s.loop=!0,h.current=s,()=>{s.pause(),h.current=null}},[]),i.useEffect(()=>{const s=h.current;if(s)if(n!=="none"){const r=d.find(u=>u.id===n);if(r&&s.src!==r.url&&r.url&&(s.src=r.url),s.volume=Math.max(0,Math.min(1,c)),o&&(r!=null&&r.url)){const u=s.play();u!==void 0&&u.catch(a=>{console.debug("Ambience play failed:",a)})}else s.pause()}else s.pause()},[n,o,c,d]),h},Y=({title:n,category:o,onClose:c})=>{const{preferences:l,updateAudioSettings:h}=I(),{library:d}=y(),{audio:s,goals:r}=l,u=()=>{switch(o){case"breathwork":return r.breathworkMinutes||20;case"meditation":return r.meditationMinutes||20;case"yoga":return r.yogaMinutes||20;case"mantra":return r.mantraMinutes||20;default:return 20}},[a,g]=i.useState(!1),[m,N]=i.useState(u()),[x,f]=i.useState(m*60),[b,S]=i.useState(!1),[j,C]=i.useState(s.ambienceId),[p,M]=i.useState(!0);K(j,a,s.masterVolume);const z=i.useRef(Date.now()),k=i.useRef(null);i.useEffect(()=>{a||f(m*60)},[m,a]),i.useEffect(()=>{if(a&&x>0)k.current=setInterval(()=>{f(t=>t-1)},1e3);else if(x===0&&a){if(g(!1),p){const t=d.chimeThemes.find(w=>w.id===s.chimeThemeId)||d.chimeThemes[0];T(t.frequencies.exhale,t.soundType,2.5,s.masterVolume)}v()}return()=>clearInterval(k.current)},[a,x,p]);const v=()=>{const t=m*60-x;t>30&&$({id:Date.now().toString(),date:new Date().toISOString(),type:o,title:n,durationSeconds:t})},D=()=>{v(),c()},_=()=>{g(!a),a||(z.current=Date.now())},A=t=>{const w=Math.floor(t/60),E=t%60;return`${w}:${E.toString().padStart(2,"0")}`};return e.jsxs("div",{className:"fixed inset-0 z-[60] flex flex-col bg-black overflow-hidden animate-fade-in",children:[e.jsx("style",{children:`
            @keyframes smoke-rise {
                0% { transform: translateY(0) scale(1); opacity: 0; }
                20% { opacity: 0.4; }
                100% { transform: translateY(-100px) scale(2); opacity: 0; }
            }
            .smoke-particle {
                position: absolute;
                background: radial-gradient(circle, rgba(255,255,255,0.4) 0%, transparent 70%);
                border-radius: 50%;
                filter: blur(8px);
                animation: smoke-rise 6s infinite;
            }
            @keyframes flicker {
                0%, 100% { opacity: 0.9; transform: scale(1); }
                50% { opacity: 0.7; transform: scale(0.95); }
                70% { opacity: 1; transform: scale(1.05); }
            }
        `}),e.jsxs("div",{className:"absolute inset-0 z-0",children:[e.jsx("img",{src:"https://www.mangeshda.org/sites/default/files/2020-04/sadguru-mangeshda-darkness-to-light.jpg",alt:"Sadguru Mangeshda",className:"w-full h-full object-cover opacity-60"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black via-black/40 to-black/60"})]}),e.jsxs("div",{className:"relative z-20 flex justify-between items-center p-6 pt-8",children:[e.jsx("button",{onClick:D,className:"p-3 bg-white/10 hover:bg-white/20 rounded-full backdrop-blur-md transition-colors text-white",children:e.jsx(P,{size:24})}),e.jsx("button",{onClick:()=>S(!b),className:`p-3 rounded-full backdrop-blur-md transition-colors ${b?"bg-white/30 text-white":"bg-white/10 text-white/80 hover:bg-white/20"}`,children:e.jsx(R,{size:22})})]}),b&&e.jsx("div",{className:"absolute top-24 right-6 z-40 w-64 bg-black/80 backdrop-blur-xl border border-white/10 rounded-3xl p-5 animate-fade-in text-white",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-bold text-white/40 uppercase tracking-widest mb-2 block",children:"Ambience"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:d.ambientSounds.map(t=>e.jsx("button",{onClick:()=>C(t.id),className:`p-2 rounded-lg text-xs font-bold transition-all ${j===t.id?"bg-white text-black":"bg-white/10 text-white/60"}`,children:t.name},t.id))})]}),e.jsxs("div",{className:"flex justify-between items-center pt-2 border-t border-white/10",children:[e.jsx("span",{className:"text-xs font-bold text-white/40 uppercase tracking-widest",children:"End Chime"}),e.jsx("button",{onClick:()=>M(!p),className:`p-2 rounded-full ${p?"bg-white/20 text-white":"bg-white/5 text-white/40"}`,children:p?e.jsx(B,{size:16}):e.jsx(L,{size:16})})]})]})}),e.jsxs("div",{className:"relative z-10 flex-1 flex flex-col items-center justify-center text-center p-6",children:[e.jsx("h2",{className:"text-3xl font-serif text-white/90 mb-2",children:n}),e.jsx("p",{className:"text-white/50 text-sm uppercase tracking-[0.2em] mb-12",children:"Self Practice"}),e.jsx("div",{className:"mb-12",children:e.jsx("span",{className:"text-7xl font-mono font-light text-white tabular-nums tracking-tight drop-shadow-2xl",children:A(x)})}),e.jsxs("div",{className:"relative w-40 h-40 flex items-center justify-center mb-12",children:[a&&e.jsxs("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-full h-64 -mt-32 pointer-events-none",children:[e.jsx("div",{className:"smoke-particle w-10 h-10 left-[45%] top-[80%]",style:{animationDelay:"0s"}}),e.jsx("div",{className:"smoke-particle w-12 h-12 left-[50%] top-[85%]",style:{animationDelay:"2s"}}),e.jsx("div",{className:"smoke-particle w-8 h-8 left-[40%] top-[75%]",style:{animationDelay:"4s"}})]}),e.jsx("div",{className:`absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-[20px] transition-opacity duration-1000 ${a?"opacity-100":"opacity-60"}`,children:e.jsx("div",{className:"w-8 h-12 bg-gradient-to-t from-orange-500 via-yellow-400 to-white rounded-[50%_50%_50%_50%_/_60%_60%_40%_40%] blur-[2px] shadow-[0_0_20px_rgba(255,200,0,0.6)]",style:{animation:"flicker 0.2s infinite alternate"}})}),e.jsxs("svg",{width:"100",height:"60",viewBox:"0 0 100 60",className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-[-10px] drop-shadow-2xl",children:[e.jsx("path",{d:"M10 30 Q50 60 90 30 Q50 60 10 30 Z",fill:"#b45309",stroke:"#78350f",strokeWidth:"2"}),e.jsx("ellipse",{cx:"50",cy:"30",rx:"40",ry:"10",fill:"#78350f",opacity:"0.5"})]})]}),e.jsxs("div",{className:"w-full max-w-sm",children:[!a&&e.jsxs("div",{className:"mb-8 px-4",children:[e.jsxs("div",{className:"flex justify-between text-xs text-white/50 font-bold mb-2 uppercase tracking-wide",children:[e.jsx("span",{children:"Duration"}),e.jsxs("span",{children:[m," Min"]})]}),e.jsx("input",{type:"range",min:"5",max:"60",step:"5",value:m,onChange:t=>{N(parseInt(t.target.value)),f(parseInt(t.target.value)*60)},className:"w-full h-1 bg-white/20 rounded-full appearance-none cursor-pointer [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-4 [&::-webkit-slider-thumb]:h-4 [&::-webkit-slider-thumb]:bg-amber-500 [&::-webkit-slider-thumb]:rounded-full"})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx("button",{onClick:_,className:`w-20 h-20 rounded-full flex items-center justify-center shadow-glow transition-transform hover:scale-105 active:scale-95 ${a?"bg-white/10 border border-white/20 text-white":"bg-white text-black"}`,children:a?e.jsx(O,{size:32,fill:"currentColor"}):e.jsx(F,{size:32,fill:"currentColor",className:"ml-1"})})})]})]})]})},q=({filters:n,selected:o,onSelect:c})=>e.jsxs("div",{className:"flex overflow-x-auto pb-2 pt-2 -mx-6 px-6 gap-3 scrollbar-hide snap-x relative z-30 mask-linear-fade",children:[e.jsx("style",{children:`
        .mask-linear-fade {
          mask-image: linear-gradient(to right, black 90%, transparent 100%);
          -webkit-mask-image: linear-gradient(to right, black 90%, transparent 100%);
        }
      `}),n.map(l=>e.jsx("button",{onClick:()=>c(l),className:`
            snap-start flex-shrink-0 px-5 py-2.5 rounded-2xl text-sm font-bold uppercase tracking-wider transition-all duration-300 border min-h-[44px]
            ${o===l?"bg-spiritual-900 dark:bg-spiritual-100 text-white dark:text-spiritual-900 border-transparent shadow-md":"bg-transparent text-spiritual-500 dark:text-spiritual-400 border-spiritual-200 dark:border-spiritual-700 hover:border-spiritual-400 dark:hover:border-spiritual-500"}
          `,children:l},l)),e.jsx("div",{className:"w-4 flex-shrink-0"})]});export{q as F,Y as K,K as u};
