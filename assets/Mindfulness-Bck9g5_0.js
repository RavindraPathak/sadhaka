import{u as q,g as J,j as e,B as Q,s as W,t as Y}from"./index-BytG-fX6.js";import{r as i}from"./vendor-DDTLr4RV.js";import{K as Z,F as ee}from"./FilterBar-Bum94_p2.js";import{s as te,aa as se,h as D,z as ae,l as re,ao as ie,P as F,an as le,V as ne,a4 as de,G as oe}from"./utils-CadWPAO0.js";const pe=({onClose:f,initialId:u})=>{const{library:M}=q(),b=M.meditation,[a,p]=i.useState(null),[h,A]=i.useState("All"),[n,x]=i.useState(!1),[w,j]=i.useState(0),[k,$]=i.useState(0),[m,R]=i.useState(.8),[d,N]=i.useState(!1),[B,I]=i.useState(J()),[y,g]=i.useState(!1),r=i.useRef(null),c=i.useRef(null),v=i.useRef(0);i.useEffect(()=>{if(u){const t=b.find(s=>s.id===u);t&&p(t)}},[u,b]);const z=(t,s)=>{t&&t.stopPropagation();const l=Y({id:s.id,title:s.title,type:"meditation"});I(l)},S=t=>B.some(s=>s.id===t&&s.type==="meditation");i.useEffect(()=>{n?c.current=Date.now():c.current&&(v.current+=Date.now()-c.current,c.current=null)},[n]);const V=()=>{if(a&&!a.isUnguided){let t=v.current;n&&c.current&&(t+=Date.now()-c.current),t>3e4&&W({id:Date.now().toString(),date:new Date().toISOString(),type:"meditation",title:a.title,durationSeconds:Math.round(t/1e3)})}v.current=0,c.current=null,x(!1),g(!1),u?f():p(null)};i.useEffect(()=>(a&&r.current&&!a.isUnguided&&(r.current.src=a.url,r.current.volume=d?0:m,x(!1)),()=>{r.current&&(r.current.pause(),r.current.src="")}),[a]),i.useEffect(()=>{const t=r.current;if(!t)return;const s=()=>j(t.currentTime),l=()=>$(t.duration),o=()=>x(!1);return t.addEventListener("timeupdate",s),t.addEventListener("loadedmetadata",l),t.addEventListener("ended",o),()=>{t.removeEventListener("timeupdate",s),t.removeEventListener("loadedmetadata",l),t.removeEventListener("ended",o)}},[a]),i.useEffect(()=>{r.current&&(r.current.volume=d?0:m)},[m,d]);const _=()=>{r.current&&(n?r.current.pause():r.current.play(),x(!n))},U=()=>{n&&r.current&&(r.current.pause(),x(!1)),g(!0)},H=t=>{const s=Number(t.target.value);r.current&&(r.current.currentTime=s,j(s))},O=t=>{const s=parseFloat(t.target.value);R(s),s>0&&d&&N(!1)},G=()=>{N(!d)},C=t=>{if(isNaN(t))return"0:00";const s=Math.floor(t/60),l=Math.floor(t%60);return`${s}:${l.toString().padStart(2,"0")}`};if(a){if(a.isUnguided)return e.jsx(Z,{title:a.title,category:"meditation",onClose:()=>{u?f():p(null)}});const t=S(a.id),s=a.meta;return e.jsxs("div",{className:"fixed inset-0 bg-white dark:bg-slate-950 z-[60] flex flex-col landscape:flex-row animate-fade-in transition-colors",children:[e.jsx("audio",{ref:r}),e.jsxs("div",{className:"absolute top-0 left-0 w-full flex justify-between items-center p-6 z-30",children:[e.jsx("button",{onClick:V,className:"p-2 bg-gray-100 dark:bg-slate-800 rounded-full text-gray-600 dark:text-slate-300 hover:bg-gray-200 dark:hover:bg-slate-700 transition backdrop-blur-md","aria-label":"Back to library",children:e.jsx(te,{size:24})}),e.jsx("span",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest",children:n?"Now Playing":"Ready"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:U,className:`p-2 transition rounded-full ${y?"text-spiritual-600 bg-spiritual-100 dark:bg-spiritual-800 dark:text-spiritual-200":"text-gray-400 hover:text-spiritual-500"}`,children:e.jsx(se,{size:24})}),e.jsx("button",{onClick:l=>z(l,a),className:`p-2 transition hover:scale-110 backdrop-blur-md rounded-full ${t?"text-red-500":"text-gray-400 hover:text-red-400"}`,"aria-label":"Toggle favourite",children:e.jsx(D,{size:24,fill:t?"currentColor":"none"})})]})]}),y&&e.jsxs(Q,{onClose:()=>g(!1),title:a.title,subtitle:"Track Details",icon:e.jsx(ae,{size:24}),children:[e.jsx("div",{className:"p-6 bg-white/5 rounded-3xl border border-white/5",children:e.jsx("p",{className:"text-lg text-white/80 leading-relaxed font-medium",children:a.description})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.category&&e.jsxs("div",{className:"p-4 bg-white/5 rounded-2xl border border-white/5",children:[e.jsx("span",{className:"block text-xs font-bold text-white/40 uppercase tracking-widest mb-1",children:"Focus"}),e.jsx("span",{className:"text-lg font-bold text-white capitalize",children:s.category.join(", ")})]}),s.level&&e.jsxs("div",{className:"p-4 bg-white/5 rounded-2xl border border-white/5",children:[e.jsx("span",{className:"block text-xs font-bold text-white/40 uppercase tracking-widest mb-1",children:"Level"}),e.jsx("span",{className:"text-lg font-bold text-white capitalize",children:s.level})]}),s.style&&e.jsxs("div",{className:"p-4 bg-white/5 rounded-2xl border border-white/5",children:[e.jsx("span",{className:"block text-xs font-bold text-white/40 uppercase tracking-widest mb-1",children:"Style"}),e.jsx("span",{className:"text-lg font-bold text-white capitalize",children:s.style.replace("_"," ")})]}),s.bestTime&&e.jsxs("div",{className:"p-4 bg-white/5 rounded-2xl border border-white/5",children:[e.jsx("span",{className:"block text-xs font-bold text-white/40 uppercase tracking-widest mb-1",children:"Best Time"}),e.jsx("span",{className:"text-lg font-bold text-white capitalize",children:s.bestTime})]})]})]}),e.jsx("div",{className:"flex-1 landscape:w-1/2 flex items-center justify-center p-8 pt-20 landscape:pt-0",children:e.jsxs("div",{className:`w-64 h-64 landscape:w-56 landscape:h-56 rounded-full bg-gradient-to-br ${a.theme.gradient} shadow-2xl flex items-center justify-center relative ${n?"animate-pulse-slow":""}`,children:[e.jsx("div",{className:"absolute inset-4 rounded-full bg-white/20 backdrop-blur-sm border border-white/30"}),e.jsx(re,{size:64,className:"text-white/80 relative z-10"})]})}),e.jsxs("div",{className:"bg-spiritual-50 dark:bg-slate-900 rounded-t-[3rem] landscape:rounded-none landscape:w-1/2 landscape:h-full p-10 shadow-[0_-10px_40px_rgba(0,0,0,0.05)] dark:shadow-[0_-10px_40px_rgba(0,0,0,0.2)] transition-colors flex flex-col justify-center",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-3xl font-serif text-spiritual-900 dark:text-spiritual-100 mb-2",children:a.title}),e.jsx("p",{className:"text-spiritual-500 dark:text-spiritual-400 text-lg",children:a.author})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("input",{type:"range",min:"0",max:k||0,value:w,onChange:H,"aria-label":"Seek progress",className:"w-full h-1.5 bg-spiritual-200 dark:bg-slate-700 rounded-lg appearance-none cursor-pointer [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-4 [&::-webkit-slider-thumb]:h-4 [&::-webkit-slider-thumb]:bg-spiritual-600 [&::-webkit-slider-thumb]:dark:bg-spiritual-400 [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:shadow-md"}),e.jsxs("div",{className:"flex justify-between text-xs text-spiritual-400 dark:text-slate-500 mt-3 font-medium",children:[e.jsx("span",{children:C(w)}),e.jsx("span",{children:C(k)})]})]}),e.jsx("div",{className:"flex items-center justify-center mb-8",children:e.jsx("button",{onClick:_,className:"w-20 h-20 bg-spiritual-800 dark:bg-spiritual-700 text-white rounded-full flex items-center justify-center shadow-xl hover:bg-spiritual-900 dark:hover:bg-spiritual-600 hover:scale-105 transition-all","aria-label":n?"Pause":"Play",children:n?e.jsx(ie,{size:28,fill:"white"}):e.jsx(F,{size:28,fill:"white",className:"ml-1"})})}),e.jsxs("div",{className:"flex items-center gap-3 px-4 max-w-xs mx-auto w-full",children:[e.jsx("button",{onClick:G,className:"text-spiritual-400 dark:text-slate-500 hover:text-spiritual-600 dark:hover:text-spiritual-300 transition-colors","aria-label":d?"Unmute":"Mute",children:d||m===0?e.jsx(le,{size:20}):e.jsx(ne,{size:20})}),e.jsx("input",{type:"range",min:"0",max:"1",step:"0.05",value:d?0:m,onChange:O,"aria-label":"Volume",className:"flex-1 h-1 bg-spiritual-200 dark:bg-slate-700 rounded-lg appearance-none cursor-pointer [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-3 [&::-webkit-slider-thumb]:h-3 [&::-webkit-slider-thumb]:bg-spiritual-400 [&::-webkit-slider-thumb]:rounded-full"})]})]})]})}const K=b.filter(t=>{var s,l;return!!(h==="All"||(s=t.meta)!=null&&s.level&&h===t.meta.level.charAt(0).toUpperCase()+t.meta.level.slice(1)||(l=t.meta)!=null&&l.category&&t.meta.category.map(o=>o.charAt(0).toUpperCase()+o.slice(1)).includes(h))});return e.jsxs("div",{className:"h-[100dvh] bg-spiritual-50 dark:bg-spiritual-deep animate-fade-in flex flex-col overflow-hidden",children:[e.jsx("div",{className:"flex-none pt-8 pb-4 px-6 rounded-b-[2rem] shadow-soft flex flex-col bg-gradient-to-br from-indigo-50 via-white to-indigo-100 dark:from-indigo-900 dark:via-spiritual-deep dark:to-indigo-900/10 z-20",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:f,className:"p-3 bg-white dark:bg-white/10 rounded-full shadow-sm hover:scale-105 transition-transform text-spiritual-600 dark:text-spiritual-200","aria-label":"Back",children:e.jsx(de,{size:20})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-spiritual-900 dark:text-spiritual-50",children:"Dhyana Dharana"}),e.jsx("p",{className:"text-xs text-spiritual-500 dark:text-spiritual-400 font-bold uppercase tracking-wider",children:"Inner stillness"})]})]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto scrollbar-hide pb-36",children:[e.jsx("div",{className:"sticky top-0 z-40 px-6 py-2 bg-spiritual-50 dark:bg-spiritual-deep mb-4 shadow-sm",children:e.jsx(ee,{filters:["All","Beginner","Intermediate","Advanced","Spiritual","Calm","Healing","Sleep","Focus"],selected:h,onSelect:A})}),e.jsx("div",{className:"px-6 space-y-5",children:K.map(t=>{var o,T,E,P,L;const s=S(t.id);let l="bg-green-500";return((o=t.meta)==null?void 0:o.level)==="intermediate"&&(l="bg-amber-500"),((T=t.meta)==null?void 0:T.level)==="advanced"&&(l="bg-red-500"),e.jsxs("div",{onClick:()=>p(t),className:"relative overflow-hidden bg-white dark:bg-spiritual-900/60 p-6 rounded-[2.5rem] shadow-soft border border-spiritual-100 dark:border-spiritual-700/50 flex items-center gap-5 cursor-pointer hover:shadow-lg hover:-translate-y-1 transition-all group",children:[e.jsx("div",{className:`absolute inset-0 opacity-0 group-hover:opacity-10 transition-opacity bg-gradient-to-br ${t.theme.gradient}`}),e.jsx("div",{className:`w-12 h-12 rounded-2xl bg-gradient-to-br ${t.theme.gradient} flex items-center justify-center flex-shrink-0 shadow-inner relative z-10 shadow-md group-hover:scale-105 transition-transform`,children:e.jsx("div",{className:"bg-white/20 w-10 h-10 rounded-full flex items-center justify-center backdrop-blur-sm",children:e.jsx(F,{size:16,fill:"currentColor",className:"text-spiritual-800/60 ml-0.5"})})}),e.jsxs("div",{className:"flex-1 min-w-0 relative z-10",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${l}`,title:`Level: ${(E=t.meta)==null?void 0:E.level}`}),e.jsx("span",{className:"text-xs font-bold text-spiritual-400 dark:text-spiritual-500 uppercase tracking-wide",children:((L=(P=t.meta)==null?void 0:P.category)==null?void 0:L[0])||"Guided"})]}),e.jsx("h3",{className:"text-lg font-bold text-spiritual-900 dark:text-spiritual-100 mb-0.5",children:t.title}),e.jsxs("div",{className:"flex items-center text-xs text-spiritual-400 mt-1",children:[e.jsx(oe,{size:10,className:"mr-1"})," ",t.duration>0?t.durationDisplay:"Timer"]})]}),e.jsx("div",{className:"flex flex-col items-center gap-2 pr-2 relative z-10",children:e.jsx("button",{onClick:X=>z(X,t),className:`p-2 rounded-full transition-colors ${s?"text-red-500 bg-red-50 dark:bg-red-900/20":"text-spiritual-300 dark:text-spiritual-600 hover:text-red-400 hover:bg-spiritual-50 dark:hover:bg-spiritual-800"}`,children:e.jsx(D,{size:20,fill:s?"currentColor":"none"})})})]},t.id)})})]})]})};export{pe as default};
